<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ants species coexistence</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#functions" id="toc-functions" class="nav-link active" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#calculations" id="toc-calculations" class="nav-link" data-scroll-target="#calculations">Calculations</a></li>
  </ul></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a>
  <ul class="collapse">
  <li><a href="#traits---invidividuals" id="toc-traits---invidividuals" class="nav-link" data-scroll-target="#traits---invidividuals">Traits - Invidividuals</a></li>
  <li><a href="#populations" id="toc-populations" class="nav-link" data-scroll-target="#populations">Populations</a></li>
  <li><a href="#sites---site-level" id="toc-sites---site-level" class="nav-link" data-scroll-target="#sites---site-level">Sites - site-level</a></li>
  </ul></li>
  <li><a href="#functional-dispersion" id="toc-functional-dispersion" class="nav-link" data-scroll-target="#functional-dispersion">Functional dispersion</a>
  <ul class="collapse">
  <li><a href="#null-modelses-calculation" id="toc-null-modelses-calculation" class="nav-link" data-scroll-target="#null-modelses-calculation">Null model/SES calculation</a></li>
  <li><a href="#functional-dispersion-and-pc-gradient" id="toc-functional-dispersion-and-pc-gradient" class="nav-link" data-scroll-target="#functional-dispersion-and-pc-gradient">Functional dispersion and PC gradient</a></li>
  </ul></li>
  <li><a href="#taxonomic-diversity" id="toc-taxonomic-diversity" class="nav-link" data-scroll-target="#taxonomic-diversity">Taxonomic diversity</a>
  <ul class="collapse">
  <li><a href="#species-richness-pc1" id="toc-species-richness-pc1" class="nav-link" data-scroll-target="#species-richness-pc1">Species richness ~ PC1</a></li>
  <li><a href="#accumulation-curves" id="toc-accumulation-curves" class="nav-link" data-scroll-target="#accumulation-curves">Accumulation curves</a></li>
  <li><a href="#taxonomic-beta-diversity" id="toc-taxonomic-beta-diversity" class="nav-link" data-scroll-target="#taxonomic-beta-diversity">Taxonomic beta diversity</a></li>
  <li><a href="#phylogenetic-signal" id="toc-phylogenetic-signal" class="nav-link" data-scroll-target="#phylogenetic-signal">Phylogenetic signal</a></li>
  <li><a href="#phylo-and-functional-plots-together" id="toc-phylo-and-functional-plots-together" class="nav-link" data-scroll-target="#phylo-and-functional-plots-together">Phylo and functional plots together</a></li>
  <li><a href="#variance-partitioning" id="toc-variance-partitioning" class="nav-link" data-scroll-target="#variance-partitioning">Variance partitioning</a></li>
  <li><a href="#cwm-pc2" id="toc-cwm-pc2" class="nav-link" data-scroll-target="#cwm-pc2">CWM ~ PC2</a></li>
  </ul></li>
  <li><a href="#itv" id="toc-itv" class="nav-link" data-scroll-target="#itv">ITV</a>
  <ul class="collapse">
  <li><a href="#body-size" id="toc-body-size" class="nav-link" data-scroll-target="#body-size">Body size</a></li>
  <li><a href="#femur-length" id="toc-femur-length" class="nav-link" data-scroll-target="#femur-length">Femur length</a></li>
  <li><a href="#scape-length" id="toc-scape-length" class="nav-link" data-scroll-target="#scape-length">Scape length</a></li>
  <li><a href="#mandible-length" id="toc-mandible-length" class="nav-link" data-scroll-target="#mandible-length">Mandible length</a></li>
  <li><a href="#eye-length" id="toc-eye-length" class="nav-link" data-scroll-target="#eye-length">Eye length</a></li>
  <li><a href="#head-width" id="toc-head-width" class="nav-link" data-scroll-target="#head-width">Head width</a></li>
  <li><a href="#itv-plots" id="toc-itv-plots" class="nav-link" data-scroll-target="#itv-plots">ITV Plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Ants species coexistence</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggvegan)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FD)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="functions" class="level1">
<h1>Functions</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>multiple.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd</span>(x))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see Cleaning.R in scripts folder for data cleaning</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Clean Data/ants_wide.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Clean Data/ants.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>site_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Clean Data/sites_joined.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">right_join</span>(site_data, cov, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"month"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(cov, <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">19</span>, <span class="dv">22</span><span class="sc">:</span><span class="dv">36</span>, <span class="dv">39</span><span class="sc">:</span><span class="dv">41</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#total count of ants</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(cov<span class="sc">$</span>abun)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15519</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add ecostress sensor data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>eco <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Clean Data/ecostress.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>eco <span class="ot">&lt;-</span> <span class="fu">select</span>(eco, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">11</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>eco <span class="ot">&lt;-</span> <span class="fu">rename</span>(eco, <span class="at">month =</span> Category, <span class="at">Site =</span> ID, <span class="at">esi =</span> ECO4ESIPTJPL_001_Evaporative_Stress_Index_PT_JPL_ESIavg)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">right_join</span>(eco, cov, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"month"</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#read in foundation plant identity for the sites</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>shrubs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Clean Data/shrubs.csv"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">right_join</span>(cov, shrubs, <span class="at">by =</span> <span class="st">"Site"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>cov<span class="sc">$</span>shrub.site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cov<span class="sc">$</span>shrub.site)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#read in ndvi and soil data</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>ndvi <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"raw data/sites_remotesensing.csv"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ndvi <span class="ot">&lt;-</span> <span class="fu">select</span>(ndvi, <span class="dv">7</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Site =</span> site)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>ndvi<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"MoV"</span>, <span class="st">"Mov"</span>, ndvi<span class="sc">$</span>Site)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">right_join</span>(cov, ndvi, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"month"</span>))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>cov<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">paste</span>(cov<span class="sc">$</span>Site, cov<span class="sc">$</span>month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cleaning the raw trait data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"raw data/Traits.csv"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check for spelling mistakes in trait labels</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(traits<span class="sc">$</span>Trait)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Scale bar"       "Femur"           "Scape"           "Mandible length"
[5] "Head length"     "Eye length"      "Eye width"       "Head width"     
[9] "Webers"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I don't trust the eye width measurements because they were measured from the front</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">filter</span>(traits, Trait <span class="sc">!=</span> <span class="st">"Eye width"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(traits$Photo)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#extract site IDs from photo names</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">separate</span>(traits, Photo, <span class="fu">c</span>(<span class="st">"Site"</span>, <span class="st">"Slide"</span>, <span class="st">"Specimen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 3 pieces. Additional pieces discarded in 1833 rows [10, 11, 12, 13,
14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, ...].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Papl"</span>, <span class="st">"PaPl"</span>, traits<span class="sc">$</span>Site)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(traits<span class="sc">$</span>Site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Aven"  "CaS"   "CaSl"  "Coal"  "Lok"   "Mov"   "PaPl"  "SemiT" "SiCr" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> traits[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the double pheidole entry</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> traits[<span class="sc">-</span><span class="dv">2</span>,]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#need to divide the trait values by weber's body length. I want to do this at the individual level, not dividing means by mean webers</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">select</span>(traits, <span class="sc">-</span>X, <span class="sc">-</span>Label)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(traits, <span class="at">names_from =</span> Trait, <span class="at">values_from =</span> Measure)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">mutate</span>(traits, <span class="at">Femur.w =</span> Femur<span class="sc">/</span>Webers, <span class="at">Scape.w =</span> Scape<span class="sc">/</span>Webers, <span class="at">Mandible.w =</span> <span class="st">`</span><span class="at">Mandible length</span><span class="st">`</span><span class="sc">/</span>Webers, <span class="at">Headl.w =</span> <span class="st">`</span><span class="at">Head length</span><span class="st">`</span><span class="sc">/</span>Webers, <span class="at">Eyel.w =</span> <span class="st">`</span><span class="at">Eye length</span><span class="st">`</span><span class="sc">/</span>Webers, <span class="at">Headw.w =</span> <span class="st">`</span><span class="at">Head width</span><span class="st">`</span><span class="sc">/</span>Webers)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(traits, <span class="dv">5</span><span class="sc">:</span><span class="dv">17</span>, <span class="at">names_to =</span> <span class="st">"Trait"</span>, <span class="at">values_to =</span> <span class="st">"Measure"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#check for ant species name typoes</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(traits<span class="sc">$</span>X<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Pheidole hyatti"           "Solenopsis xyloni"        
 [3] "Dorymyrmex bicolor"        "Messor pergandei"         
 [5] "Forelius pruinosis"        "Cyphomyrmex wheeleri"     
 [7] "Dorymyrmex insanus"        "Messor andrei"            
 [9] "Myrmecocystus"             "Pogonomyrmex californicus"
[11] "Temnothorax andrei"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#some traits are NA because of damage to the specimen</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">drop_na</span>(traits)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the mean value of the trait for each species at each site (population level trait values)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>traits.ag <span class="ot">&lt;-</span> <span class="fu">group_by</span>(traits, Site, X<span class="fl">.1</span>, Trait) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Measure), <span class="at">sd =</span> <span class="fu">sd</span>(Measure))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site', 'X.1'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a data frame of the mean values for each species across all sites (species level trait values)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>traits.sp <span class="ot">&lt;-</span> <span class="fu">group_by</span>(traits, X<span class="fl">.1</span>, Trait) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Measure), <span class="at">sd =</span> <span class="fu">sd</span>(Measure))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'X.1'. You can override using the `.groups`
argument.</code></pre>
</div>
</div>
<section id="calculations" class="level2">
<h2 class="anchored" data-anchor-id="calculations">Calculations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert to presence absence</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>long.pres <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(wide, <span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">names_to =</span> <span class="st">"species"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>long.pres <span class="ot">&lt;-</span> <span class="fu">mutate</span>(long.pres, <span class="at">count.bin =</span> <span class="fu">ifelse</span>(count <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#get total abundance per trap</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>long.pres <span class="ot">&lt;-</span> <span class="fu">group_by</span>(long.pres, uniID) <span class="sc">%&gt;%</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(count.bin)) </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate relative abundances</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>long.pres <span class="ot">&lt;-</span> long.pres <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rel.abun =</span> count.bin<span class="sc">/</span>total)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>traits.ag <span class="ot">&lt;-</span> <span class="fu">rename</span>(traits.ag, <span class="at">species =</span> X<span class="fl">.1</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>traits.ag<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">""</span>, traits.ag<span class="sc">$</span>species)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#add sites to long</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>long.pres <span class="ot">&lt;-</span> cov <span class="sc">%&gt;%</span> <span class="fu">select</span>(Site, uniID) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(long.pres, . , <span class="at">by =</span> <span class="st">'uniID'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#this adds NA traits to 0 abundances - species isn't found at pitfall or site</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make a presence/absence pitfall trap data frame</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>spe.bin <span class="ot">&lt;-</span> long.pres</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>spe.bin <span class="ot">&lt;-</span> <span class="fu">select</span>(spe.bin, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>spe.bin <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(spe.bin, <span class="at">names_from =</span> species, <span class="at">values_from =</span> count.bin)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>spe.bin <span class="ot">&lt;-</span> <span class="fu">select</span>(spe.bin, <span class="sc">-</span><span class="dv">11</span>, <span class="sc">-</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pca" class="level1">
<h1>PCA</h1>
<section id="traits---invidividuals" class="level2">
<h2 class="anchored" data-anchor-id="traits---invidividuals">Traits - Invidividuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I want the PCA on traits</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make it wide again</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>traits.wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(traits, <span class="at">names_from =</span> Trait, <span class="at">values_from =</span> Measure)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#keep only weber length standardized traits</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>traits.wide <span class="ot">&lt;-</span> <span class="fu">select</span>(traits.wide, <span class="dv">11</span><span class="sc">:</span><span class="dv">17</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>traits.wide <span class="ot">&lt;-</span> <span class="fu">drop_na</span>(traits.wide)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>traits.st <span class="ot">&lt;-</span> <span class="fu">decostand</span>(traits.wide, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>traits.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(traits.st)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(traits.pca)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(traits.pca, <span class="at">xlab =</span> <span class="st">"PCA 33.9%"</span>, <span class="at">ylab =</span> <span class="st">"PCA 32.9%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PC3 is ~15%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="populations" class="level2">
<h2 class="anchored" data-anchor-id="populations">Populations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> traits.ag</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>trait.pop<span class="sc">$</span>spepop <span class="ot">&lt;-</span> <span class="fu">paste</span>(trait.pop<span class="sc">$</span>species, trait.pop<span class="sc">$</span>Site)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(trait.pop) <span class="sc">%&gt;%</span> <span class="fu">select</span>(spepop, Trait, mean)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(trait.pop, <span class="at">names_from =</span> Trait, <span class="at">values_from =</span> mean)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(trait.pop, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">14</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>trait.pop.st <span class="ot">&lt;-</span> <span class="fu">select</span>(trait.pop, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">decostand</span>(<span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#rename the column names for the figure</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trait.pop.st) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Eye length"</span>, <span class="st">"Femur length"</span>, <span class="st">"Head </span><span class="sc">\n</span><span class="st"> length"</span>, <span class="st">"Head</span><span class="sc">\n</span><span class="st"> Width"</span>, <span class="st">"Mandible</span><span class="sc">\n</span><span class="st"> length"</span>, <span class="st">"Scape length"</span>, <span class="st">"Weber's </span><span class="sc">\n</span><span class="st">body length"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>trait.pop.pca <span class="ot">&lt;-</span> <span class="fu">rda</span>(trait.pop.st)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trait.pop.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(X = trait.pop.st) 

Partitioning of variance:
              Inertia Proportion
Total               7          1
Unconstrained       7          1

Eigenvalues, and their contribution to the variance 

Importance of components:
                         PC1    PC2    PC3    PC4     PC5      PC6     PC7
Eigenvalue            2.5070 2.2584 1.1770 0.7987 0.15458 0.055570 0.04872
Proportion Explained  0.3581 0.3226 0.1681 0.1141 0.02208 0.007939 0.00696
Cumulative Proportion 0.3581 0.6808 0.8489 0.9630 0.98510 0.993040 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  4.325308 


Species scores

                          PC1     PC2     PC3     PC4      PC5       PC6
Eye length            -0.1767 -1.0244 -0.1420  1.2457  0.10477  0.093395
Femur length          -0.1993 -1.4027  0.7577 -0.1532  0.05924 -0.170440
Head \n length         1.5386 -0.2189 -0.1218  0.1530 -0.44827  0.063381
Head\n Width           1.4624  0.3105  0.4858  0.3491  0.08221 -0.215250
Mandible\n length      1.3472 -0.6678  0.1603 -0.4818  0.33976  0.195884
Scape length          -0.3352 -1.5033 -0.1533 -0.4137 -0.23448 -0.004772
Weber's \nbody length -0.4429  0.4108  1.5004  0.1038 -0.14328  0.148333


Site scores (weighted sums of species scores)

           PC1      PC2       PC3     PC4      PC5      PC6
sit1  -1.25743  1.17003 -1.006316  0.4318  0.16247  1.08859
sit2   0.07348 -0.63307  0.001587  0.9435  0.55676 -0.15860
sit3   0.10035  0.28019 -0.835489  0.2037 -0.78715 -0.68807
sit4  -0.11843  0.41555  1.059308  0.7186  0.44925 -1.15434
sit5  -0.31570 -0.68016 -0.282304 -0.5964  0.13460  0.37362
sit6   0.74161  0.50801 -0.400498 -0.6450  0.59087  0.83737
sit7  -0.54973 -0.12228 -0.018679  0.4422  0.72323 -0.03024
sit8   0.08209 -0.45712 -0.331333  0.4141 -0.17494 -1.02519
sit9   0.03929  0.19970 -0.609124  0.4344 -0.48653 -1.25146
sit10 -0.39156  0.88290  1.405785 -0.2830 -0.94520  0.26177
sit11  0.52052 -0.46346  0.422658  0.9600 -0.35682 -0.41823
sit12 -0.61492 -0.10196  0.740425 -0.3379  0.37339  0.31994
sit13 -0.16380 -0.85734 -0.102693 -0.7965  0.52466  0.34867
sit14  1.30768 -0.00861 -0.007875 -0.4919  0.18310 -0.56861
sit15  0.26887 -0.77746  0.185309  0.8498  0.27848  0.29414
sit16 -0.03945 -0.40208  0.015923  0.6335  0.13965  0.32880
sit17 -0.25350  0.92686  1.331797 -0.3559 -0.30705  0.24633
sit18 -0.76018  0.00121  0.581893 -0.3685  0.31250  0.69682
sit19 -0.26309 -0.84188 -0.252197 -0.6362 -0.58082 -0.24173
sit20  1.21189  0.13299  1.307884  0.5640  0.69689  0.24658
sit21  0.92381  0.33488 -0.110765 -0.9947  0.98653  0.28583
sit22 -1.10418  1.40531 -0.725630  0.1821 -0.02269 -1.00948
sit23  0.02086 -0.50581  0.026615  0.8573  0.31400 -0.06155
sit24  0.19997 -0.55557 -0.361050  0.3125  0.73116  1.20797
sit25 -0.38207 -0.74295 -0.219071 -0.6894 -0.40849 -0.12945
sit26  0.61948  0.58785 -0.414733 -0.4978 -0.04579 -0.55950
sit27 -0.22399 -0.15329 -0.086018  0.6899  0.04607 -0.06113
sit28  0.74740 -0.29243  0.913310  0.7581 -0.41624  0.08193
sit29 -0.64059 -0.31894  0.299796 -0.2970  0.43947  0.41555
sit30 -0.52138 -0.61739 -0.397568 -0.4950 -0.29021 -0.51933
sit31  0.75207  0.53673 -0.339210 -0.5093 -0.32128  0.07954
sit32  0.02154 -0.56995 -0.190266  0.8382  0.04218  0.52305
sit33  0.35216 -0.05693  0.725188  0.5584 -0.34317  0.01420
sit34 -0.72746  0.12963  0.457274 -0.3425 -0.41348 -0.03825
sit35 -0.36985 -0.68566 -0.154910 -0.8299  0.17622  0.13870
sit36  1.07301  0.27959 -0.146515 -0.4081 -0.10280 -0.50485
sit37 -0.28488  0.51805 -0.521273  0.1924  0.38419 -0.94546
sit38 -0.29382  0.99462  1.435078 -0.2762 -0.88692  0.50829
sit39 -0.59135 -0.25519  0.328696 -0.2345  0.44186  0.17430
sit40 -0.41548 -0.61960 -0.172560 -0.6884 -0.32450  0.12250
sit41  0.72063  0.64465 -0.439537 -0.6063 -0.08582  0.56966
sit42  0.65457  0.62725 -1.222604  1.0584 -2.21323  1.75579
sit43  0.09375 -0.41415 -0.101720  0.6696  0.17689  0.09258
sit44 -0.75541  0.18755  0.560996 -0.3577 -0.67055 -0.80330
sit45 -0.11440 -0.81146 -0.236674 -0.6943 -0.57049  0.62003
sit46  0.64722  0.60986 -0.238973 -0.8057  0.88478 -0.37328
sit47 -0.92769  1.15961 -0.717894  0.6739  1.57847  0.34707
sit48 -0.13297 -0.40093 -0.099493  0.7395  0.10783 -0.15132
sit49  0.20079  0.28479 -0.629766  0.1702 -0.10950 -0.63534
sit50 -0.28079 -0.88353 -0.225329 -0.6004 -0.89400 -0.58909
sit51  1.12105  0.41137 -0.201453 -0.4573  0.32213 -0.06183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pcplot1 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(trait.pop.pca, <span class="at">xlab =</span> <span class="st">"PCA Axis 1 (35.8%)"</span>, <span class="at">ylab =</span> <span class="st">"PCA Axis 2 (32.2%)"</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
â„¹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pcplot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PCA3 ~ 16%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sites---site-level" class="level2">
<h2 class="anchored" data-anchor-id="sites---site-level">Sites - site-level</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> <span class="fu">select</span>(cov, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">15</span>, <span class="dv">37</span><span class="sc">:</span><span class="dv">43</span>, sites) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>env2_sitelabels <span class="ot">&lt;-</span> env2<span class="sc">$</span>sites</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>env2 <span class="ot">&lt;-</span> <span class="fu">select</span>(env2, <span class="sc">-</span>sites)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#standardize to mean of zero etc</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>env.d2 <span class="ot">&lt;-</span> <span class="fu">decostand</span>(env2, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>env.pca2 <span class="ot">&lt;-</span> <span class="fu">rda</span>(env.d2)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">summary</span>(env.pca2)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a<span class="sc">$</span>cont<span class="sc">$</span>importance</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> b[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> <span class="fu">round</span>(prop1, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>prop2 <span class="ot">&lt;-</span> b[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>prop2 <span class="ot">&lt;-</span> <span class="fu">round</span>(prop2, <span class="at">digits =</span> <span class="dv">2</span>)    </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(env.pca2)</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(env.pca2, xlab = paste("PCA", prop1), ylab = paste("PCA", prop2))</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">#sitescores &lt;- scores(env.pca2, c(1,2, 3), 'sites')</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>envreduce <span class="ot">&lt;-</span> <span class="fu">select</span>(env2, <span class="sc">-</span>esi, <span class="sc">-</span>arid, <span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">12</span>, <span class="sc">-</span><span class="dv">13</span>, <span class="sc">-</span><span class="dv">14</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>env.reduce <span class="ot">&lt;-</span> <span class="fu">decostand</span>(envreduce, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(env.reduce) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Mean Cover"</span>, <span class="st">"Variation Cover"</span>, <span class="st">"Mean Veg Height"</span>, <span class="st">"Mean Annual </span><span class="sc">\n</span><span class="st"> Temperature"</span>, <span class="st">"Mean Annual </span><span class="sc">\n</span><span class="st"> Precipitation"</span>, <span class="st">"Maximum </span><span class="sc">\n</span><span class="st"> Temperature"</span>, <span class="st">"NDVI"</span>, <span class="st">"Mean Soil Temp"</span>, <span class="st">"Range Soil Temp"</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>env.pcareduce <span class="ot">&lt;-</span> <span class="fu">rda</span>(env.reduce)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">summary</span>(env.pcareduce)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> a<span class="sc">$</span>cont<span class="sc">$</span>importance</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> b[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> <span class="fu">round</span>(prop1, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>prop2 <span class="ot">&lt;-</span> b[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>prop2 <span class="ot">&lt;-</span> <span class="fu">round</span>(prop2, <span class="at">digits =</span> <span class="dv">2</span>)    </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(env.pcareduce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(X = env.reduce) 

Partitioning of variance:
              Inertia Proportion
Total               9          1
Unconstrained       9          1

Eigenvalues, and their contribution to the variance 

Importance of components:
                         PC1    PC2    PC3     PC4     PC5     PC6     PC7
Eigenvalue            4.3345 1.5521 1.3003 0.74383 0.51194 0.29397 0.20677
Proportion Explained  0.4816 0.1725 0.1445 0.08265 0.05688 0.03266 0.02297
Cumulative Proportion 0.4816 0.6541 0.7985 0.88118 0.93807 0.97073 0.99370
                           PC8       PC9
Eigenvalue            0.051576 0.0050793
Proportion Explained  0.005731 0.0005644
Cumulative Proportion 0.999436 1.0000000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  3.911145 


Species scores

                                 PC1      PC2      PC3      PC4      PC5
Mean Cover                   -0.1994 -1.18939  0.20134  0.03781  0.19724
Variation Cover               0.9554  0.52540 -0.12051  0.16815 -0.54976
Mean Veg Height               0.5946 -0.03471  0.78897 -0.79956 -0.15408
Mean Annual \n Temperature    1.2517 -0.18078 -0.20057  0.03157  0.08080
Mean Annual \n Precipitation -1.1162  0.49376  0.32654 -0.13258  0.07554
Maximum \n Temperature        1.0813 -0.63138  0.01782  0.10157 -0.26002
NDVI                          0.3127  0.18047  0.98632  0.73604  0.10852
Mean Soil Temp                0.9855  0.36868 -0.47134 -0.06050  0.53397
Range Soil Temp               1.0052  0.32019  0.43635 -0.14480  0.35849
                                  PC6
Mean Cover                   -0.29603
Variation Cover              -0.30644
Mean Veg Height               0.20243
Mean Annual \n Temperature    0.08483
Mean Annual \n Precipitation -0.18860
Maximum \n Temperature        0.03410
NDVI                          0.18986
Mean Soil Temp                0.12931
Range Soil Temp              -0.42478


Site scores (weighted sums of species scores)

           PC1     PC2       PC3     PC4       PC5      PC6
sit1   0.64351 -0.5007 -0.725438 -0.7455 -0.810918 -0.14371
sit2  -0.74194  0.5412  0.108352 -0.1507  0.206381 -0.08248
sit3  -1.20898  0.7029 -0.331662 -0.0428  0.490721 -0.74433
sit4   0.56856  0.3548  0.266016  0.2545 -1.381324  0.36172
sit5   0.51013 -0.5677 -0.132058 -1.3162  1.245698  0.41372
sit6  -0.28201 -0.5827 -0.649898  0.4630  0.427861  1.40192
sit7  -0.74000 -1.2969  1.565620 -0.4170  0.172264 -0.45283
sit8   0.94709  0.8571 -0.801954  0.6558  0.591111 -0.91391
sit9  -0.19825 -0.6408 -0.893368  0.7572 -0.530083 -0.24337
sit10  0.83712 -0.9331  0.743799 -0.4717  1.040020 -0.92332
sit11 -0.84470  0.8108  0.370045 -0.7902  0.063900  0.14024
sit12 -1.02926  1.4030  0.326255 -0.6496  0.289992  1.53975
sit13  0.32920 -0.7569  0.557304  0.4144  0.006087  0.11699
sit14  0.43428 -0.4409 -0.569616 -1.0108  1.316768  0.22559
sit15 -0.14377 -0.3449 -0.143868  1.6282  0.179381  1.31407
sit16 -0.67067 -0.2409  0.431817 -0.9580 -1.004252 -0.54094
sit17  1.22700  0.6444  1.009521  0.5959  0.499612  0.12615
sit18 -0.16853 -0.4159 -1.780906 -1.2715 -1.386545 -0.57888
sit19  1.36348  0.6556  1.488194 -0.2852 -1.007324  0.11247
sit20 -0.71362  0.9359 -0.047458  0.7364 -0.116222 -0.43942
sit21 -1.06529  0.7318  0.141801  0.4131  0.650523 -1.31995
sit22  0.32691 -0.5166 -0.009163  0.6818 -0.351307 -0.53919
sit23  0.68249  0.6844 -0.337589 -0.8470  0.243426  1.22871
sit24 -0.35134 -1.1415 -0.763602  0.9214  0.753526  0.28158
sit25 -0.79586 -0.8457  1.007258  0.4688 -0.589646 -0.17102
sit26  1.05612  1.0050 -0.663457  0.5646  0.166269 -1.03328
sit27  0.02832 -0.1018 -0.165942  0.4009 -1.165918  0.86371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pcplot2 <span class="ot">&lt;-</span> <span class="fu">autoplot</span>(env.pcareduce , <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">"PCA Axis 1 ("</span>, prop1, <span class="st">"%)"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">ylab =</span> <span class="fu">paste</span>(<span class="st">"PCA Axis 2 ("</span>, prop2, <span class="st">"%)"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.6</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>))  </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>pcplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sitescores <span class="ot">&lt;-</span> <span class="fu">scores</span>(env.pcareduce, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">display =</span> <span class="st">'sites'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sitescores <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(sitescores, env2_sitelabels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure 2</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>gA <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(pcplot1)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>gB <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(pcplot2)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.newpage</span>()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(<span class="fu">rbind</span>(gA, gB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="functional-dispersion" class="level1">
<h1>Functional dispersion</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#need a species by trait matrix, but I want to use the population means</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#make species name the name + site</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(cov, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">31</span>) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(long.pres, ., <span class="at">by =</span> <span class="st">'uniID'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#count uniID per site and month</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> site.pop <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site.x, month, uniID) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> counts <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site.x, month) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> site.pop <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Site.x, month, species) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(count.bin)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Site.x', 'month'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> <span class="fu">left_join</span>(site.pop, counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Site.x"</span>, <span class="st">"month"</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#dividing by the number of pitfalls because it differs (some were disturbed)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> <span class="fu">mutate</span>(site.pop, <span class="at">pit.abun =</span> total<span class="sc">/</span>n)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(site.pop, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>site.pop<span class="sc">$</span>site.name <span class="ot">&lt;-</span> <span class="fu">paste</span>(site.pop<span class="sc">$</span>Site.x, site.pop<span class="sc">$</span>month)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>site.pop<span class="sc">$</span>spepop <span class="ot">&lt;-</span> <span class="fu">paste</span>(site.pop<span class="sc">$</span>species, site.pop<span class="sc">$</span>Site.x)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>site.pop <span class="ot">&lt;-</span> site.pop <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(site.pop, <span class="at">names_from =</span> spepop, <span class="at">values_from =</span> pit.abun)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>wide.pop[<span class="fu">is.na</span>(wide.pop)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> wide.pop<span class="sc">$</span>site.name</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">#there are no trait measurements for species that are absent from a site</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(wide.pop) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>site.name)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> wide.pop[<span class="fu">which</span>(<span class="fu">colSums</span>(wide.pop) <span class="sc">!=</span><span class="dv">0</span>)]</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sites, wide.pop)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(wide.pop) <span class="ot">&lt;-</span> wide.pop<span class="sc">$</span>sites</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(wide.pop, <span class="sc">-</span>sites)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the two solenopsis singletons - no trait measuremnts</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>wide.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(wide.pop, <span class="sc">-</span><span class="dv">36</span>, <span class="sc">-</span><span class="dv">42</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co">#check to ensure names are matched correctly between dataframes</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wide.pop)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(trait.pop)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(trait.pop) <span class="ot">&lt;-</span> trait.pop<span class="sc">$</span>spepop</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>trait.pop <span class="ot">&lt;-</span> <span class="fu">select</span>(trait.pop, <span class="sc">-</span>spepop)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(spec, <span class="fu">row.names</span>(trait.pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section id="null-modelses-calculation" class="level2">
<h2 class="anchored" data-anchor-id="null-modelses-calculation">Null model/SES calculation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>resultsRandom <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"Clean Data/objects/FDispRandom_sites.rds"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>obsFDis <span class="ot">&lt;-</span> <span class="fu">dbFD</span>(trait.pop, wide.pop, <span class="at">w.abun =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>FDis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FEVe: Could not be calculated for communities with &lt;3 functionally singular species. 
FRic: To respect s &gt; t, FRic could not be calculated for communities with &lt;3 functionally singular species. 
FRic: Dimensionality reduction was required. The last 5 PCoA axes (out of 7 in total) were removed. 
FRic: Quality of the reduced-space representation = 0.6807776 
FDiv: Could not be calculated for communities with &lt;3 functionally singular species. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>meanNull3 <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(resultsRandom)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ES3 <span class="ot">&lt;-</span> obsFDis <span class="sc">-</span> meanNull3</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>sdNull3 <span class="ot">&lt;-</span> <span class="fu">apply</span>(resultsRandom, <span class="dv">1</span>, sd)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>SES3 <span class="ot">&lt;-</span> ES3 <span class="sc">/</span> sdNull3</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>SES_dis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SES3)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>SES_dis<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">row.names</span>(SES_dis)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#make random values negative</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>resultsRandom_neg <span class="ot">&lt;-</span> resultsRandom <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="fu">sweep</span>(resultsRandom_neg, <span class="dv">1</span>, obsFDis, <span class="st">"+"</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>diff_ses <span class="ot">&lt;-</span> <span class="fu">sweep</span>(diff, <span class="dv">1</span>, meanNull3, <span class="st">"/"</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>diff_ses_ag <span class="ot">&lt;-</span> <span class="fu">apply</span>(diff_ses, <span class="dv">1</span>, multiple.func)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>diff_ses_ag <span class="ot">&lt;-</span> <span class="fu">t</span>(diff_ses_ag)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>diff_ses_ag <span class="ot">&lt;-</span> <span class="fu">cbind</span>(diff_ses_ag, SES_dis<span class="sc">$</span>sites)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#get rid of last row</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>diff_ses_ag <span class="ot">&lt;-</span> <span class="fu">head</span>(diff_ses_ag, <span class="dv">27</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sdNull3, diff_ses_ag)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(test)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>sd)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">rename</span>(test, <span class="at">sdrand =</span> sdNull3)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>sdrand <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>sdrand)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(test<span class="sc">$</span>sd, test<span class="sc">$</span>sdrand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  test$sd and test$sdrand
t = 15.092, df = 25, p-value = 4.57e-14
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8904620 0.9768807
sample estimates:
      cor 
0.9492583 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join site-level environmental measurements to data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>cov<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">paste</span>(cov<span class="sc">$</span>Site, cov<span class="sc">$</span>month)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>SES <span class="ot">&lt;-</span> <span class="fu">select</span>(cov, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, shrub.site, sites, <span class="dv">37</span><span class="sc">:</span><span class="dv">43</span>) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(SES_dis, <span class="at">by =</span> <span class="st">"sites"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="functional-dispersion-and-pc-gradient" class="level2">
<h2 class="anchored" data-anchor-id="functional-dispersion-and-pc-gradient">Functional dispersion and PC gradient</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>SES2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(SES, sitescores)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>SES2<span class="sc">$</span>PC1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SES2<span class="sc">$</span>PC1)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>SES2<span class="sc">$</span>PC2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SES2<span class="sc">$</span>PC2)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#need to add raw FDisp score</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(SES<span class="sc">$</span>SES3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5827153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(SES<span class="sc">$</span>SES3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  SES$SES3
t = 3.5237, df = 26, p-value = 0.001597
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.2427901 0.9226405
sample estimates:
mean of x 
0.5827153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(SES3 <span class="sc">~</span>  PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), <span class="at">data =</span> SES2)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          SES3 ~ PC1 + PC2 + (1 | Site)
Data: SES2

     AIC      BIC   logLik deviance df.resid 
    70.4     76.9    -30.2     60.4       22 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev. 
 Site     (Intercept) 8.842e-10 2.973e-05
 Residual             5.480e-01 7.403e-01
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.548 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.5827     0.1425   4.090 4.31e-05 ***
PC1          -0.5067     0.1893  -2.677  0.00743 ** 
PC2          -0.1760     0.1893  -0.930  0.35239    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC    |   AICc |    BIC | R2 (cond.) | R2 (marg.) |  RMSE | Sigma
------------------------------------------------------------------
70.384 | 73.241 | 76.863 |            |      0.236 | 0.740 | 0.740</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(SES3 <span class="sc">~</span>  PC1 <span class="sc">+</span> PC2, <span class="at">data =</span> SES2)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          SES3 ~ PC1 + PC2
Data: SES2

     AIC      BIC   logLik deviance df.resid 
    68.4     73.6    -30.2     60.4       23 


Dispersion estimate for gaussian family (sigma^2): 0.548 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.5827     0.1425   4.090 4.31e-05 ***
PC1          -0.5067     0.1893  -2.677  0.00743 ** 
PC2          -0.1760     0.1893  -0.930  0.35239    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC    |   AICc |    BIC | R2 (cond.) | R2 (marg.) |  RMSE | Sigma
------------------------------------------------------------------
70.384 | 73.241 | 76.863 |            |      0.236 | 0.740 | 0.740</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   df      AIC
m1  5 70.38389
m2  4 68.38389</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SES3 <span class="sc">~</span>  PC1, <span class="at">data =</span> SES2)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SES3 ~ PC1, data = SES2)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.2155 -0.2442  0.0500  0.4122  1.6028 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.5827     0.1504   3.874 0.000684 ***
PC1          -0.5067     0.1998  -2.536 0.017849 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7816 on 25 degrees of freedom
Multiple R-squared:  0.2046,    Adjusted R-squared:  0.1728 
F-statistic:  6.43 on 1 and 25 DF,  p-value: 0.01785</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SES2, <span class="fu">aes</span>(PC1, SES3)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"SES Functional dispersion"</span>)<span class="sc">+</span>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="dv">2</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Adj r2 = "</span>,<span class="fu">signif</span>(<span class="fu">summary</span>(fit1)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a> <span class="st">" </span><span class="sc">\n</span><span class="st">P ="</span>,<span class="fu">signif</span>(<span class="fu">summary</span>(fit1)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">4</span>], <span class="dv">3</span>))) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>SES2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(SES2, <span class="at">shrub =</span> <span class="fu">ifelse</span>(shrub.site <span class="sc">==</span> <span class="st">"atriplex"</span>, <span class="st">"shrub"</span>, (<span class="fu">ifelse</span>(shrub.site <span class="sc">==</span> <span class="st">"ephedra"</span>, <span class="st">"shrub"</span>, <span class="st">"open"</span>))))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(SES3 <span class="sc">~</span>shrub <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), <span class="at">data =</span> SES2)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          SES3 ~ shrub + (1 | Site)
Data: SES2

     AIC      BIC   logLik deviance df.resid 
    74.3     79.5    -33.2     66.3       23 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.1454   0.3813  
 Residual             0.5648   0.7515  
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.565 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)  0.62506    0.33349   1.874   0.0609 .
shrubshrub  -0.06351    0.40843  -0.156   0.8764  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>SES2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(shrub) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(SES3), <span class="at">sd =</span> <span class="fu">sd</span>(SES3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  shrub  mean    sd
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 open  0.625 0.841
2 shrub 0.562 0.892</code></pre>
</div>
</div>
</section>
</section>
<section id="taxonomic-diversity" class="level1">
<h1>Taxonomic diversity</h1>
<section id="species-richness-pc1" class="level2">
<h2 class="anchored" data-anchor-id="species-richness-pc1">Species richness ~ PC1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use long pres</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#join month by identifier</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#remove the two singletons?</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">select</span>(cov, uniID, month) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(long.pres, <span class="at">by =</span> <span class="st">"uniID"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">paste</span>(alpha<span class="sc">$</span>Site, alpha<span class="sc">$</span>month)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">filter</span>(alpha, species <span class="sc">!=</span> <span class="st">"Solenopsisaurea"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Solenopsismolesta"</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">select</span>(alpha, sites, species, count.bin)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">distinct</span>(alpha)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> alpha <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(sites) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">richness =</span> <span class="fu">sum</span>(count.bin))</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">right_join</span>(alpha, SES2, <span class="at">by =</span> <span class="st">"sites"</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#same GLM or GLMM</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span>  (<span class="dv">1</span><span class="sc">|</span>Site), <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> alpha)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson  ( log )
Formula:          richness ~ PC1 + PC2 + (1 | Site)
Data: alpha

     AIC      BIC   logLik deviance df.resid 
   104.8    110.0    -48.4     96.8       23 

Random effects:

Conditional model:
 Groups Name        Variance  Std.Dev. 
 Site   (Intercept) 1.517e-10 1.232e-05
Number of obs: 27, groups:  Site, 9

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.3996     0.0962  14.549   &lt;2e-16 ***
PC1          -0.1644     0.1245  -1.321    0.187    
PC2           0.1437     0.1248   1.151    0.250    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio = 0.392
  Pearson's Chi-Squared = 9.015
                p-value = 0.996</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No overdispersion detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |  RMSE | Sigma | Score_log | Score_spherical
---------------------------------------------------------------------------------------------------
104.781 | 106.599 | 109.964 |            |      0.114 | 1.216 | 1.000 |    -1.792 |           0.188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(richness <span class="sc">~</span> PC1 <span class="sc">+</span> PC2, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> alpha)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: poisson  ( log )
Formula:          richness ~ PC1 + PC2
Data: alpha

     AIC      BIC   logLik deviance df.resid 
   102.8    106.7    -48.4     96.8       24 


Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.3996     0.0962  14.549   &lt;2e-16 ***
PC1          -0.1644     0.1245  -1.321    0.187    
PC2           0.1437     0.1248   1.151    0.250    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   df      AIC
m1  4 104.7805
m2  3 102.7805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(richness <span class="sc">~</span> month, <span class="at">family =</span> <span class="st">"poisson"</span>, <span class="at">data =</span> alpha)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = richness ~ month, family = "poisson", data = alpha)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.35812    0.16903   8.035 9.38e-16 ***
monthJuly    0.22884    0.22649   1.010    0.312    
monthSept   -0.08961    0.24458  -0.366    0.714    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12.593  on 26  degrees of freedom
Residual deviance: 10.526  on 24  degrees of freedom
AIC: 103.96

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: richness
      LR Chisq Df Pr(&gt;Chisq)
month   2.0664  2     0.3559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">table</span>(alpha<span class="sc">$</span>richness, alpha<span class="sc">$</span>sites)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(alpha<span class="sc">$</span>richness, alpha<span class="sc">$</span>Site)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(alpha$richness, alpha$Site): Chi-squared approximation
may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  alpha$richness and alpha$Site
X-squared = 43.714, df = 40, p-value = 0.3166</code></pre>
</div>
</div>
</section>
<section id="accumulation-curves" class="level2">
<h2 class="anchored" data-anchor-id="accumulation-curves">Accumulation curves</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span>wide</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>sitespec <span class="ot">&lt;-</span> <span class="fu">left_join</span>(wide, cov, <span class="at">by =</span> <span class="st">"uniID"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>sitespec <span class="ot">&lt;-</span> <span class="fu">select</span>(sitespec, <span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">17</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(5,2))</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">select</span>(sitespec, <span class="sc">-</span>Site)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co">#xi &lt;- specaccum(all,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(all,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">ci.type =</span> <span class="st">"line"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"All Sites Pooled"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"Aven"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(av,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(av,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Avenal"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cas <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"CaS"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(cas,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(cas,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Carrizo - Shrubs"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>casl <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"CaSl"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(casl,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(casl,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Carrizo - Shrubless"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>coal <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"Coal"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(coal,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(coal,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Coalinga"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>lok <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"Lok"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(lok,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(lok,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Lokern"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>mov <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"Mov"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(mov,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(mov,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Mountainview Rd"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>papl <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"PaPl"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(papl,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(papl,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Panoche Hills"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>semit <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"SemiT"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(semit,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(semit,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Semitropic"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>sicr <span class="ot">&lt;-</span> <span class="fu">filter</span>(sitespec, Site <span class="sc">==</span> <span class="st">"SiCr"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Site)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xi &lt;- specaccum(sicr,  method = "rarefaction", permutations = 100)</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">specaccum</span>(sicr,  <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(xi, xlab = "Number of Individuals", ylab = "Species Richness")</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, <span class="at">xlab =</span> <span class="st">"Number of Pitfall Samples"</span>, <span class="at">ylab =</span> <span class="st">"Species Richness"</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Silver Creek Ranch"</span>, <span class="at">adj =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="taxonomic-beta-diversity" class="level2">
<h2 class="anchored" data-anchor-id="taxonomic-beta-diversity">Taxonomic beta diversity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#functional indices are weighted so use abundance weighted beta-diversity</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betapart)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># baselgi methods for beta-diversity</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co">#we can use the occupancy population dateframe</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#drop half of species name after space</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out two singletons</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> site.pop</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> <span class="fu">separate</span>(sites_species, spepop, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"month"</span>), <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> <span class="fu">filter</span>(sites_species, species <span class="sc">!=</span> <span class="st">"Solenopsisaurea"</span> <span class="sc">&amp;</span> species <span class="sc">!=</span> <span class="st">"Solenopsismolesta"</span>)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> <span class="fu">select</span>(sites_species, <span class="sc">-</span>month)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="co"># need wide</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(sites_species, <span class="at">names_from =</span> <span class="st">"species"</span>, <span class="at">values_from =</span> <span class="st">"pit.abun"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(sites_species) <span class="ot">&lt;-</span> sites_species<span class="sc">$</span>site.name</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>sites_species <span class="ot">&lt;-</span> <span class="fu">select</span>(sites_species, <span class="sc">-</span>site.name)</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="co">#balanced variation in abundance is turnover</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="co">#abundance gradients are nestedness</span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>beta.core <span class="ot">&lt;-</span> <span class="fu">betapart.core.abund</span>(sites_species)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>betapair <span class="ot">&lt;-</span> <span class="fu">beta.pair.abund</span>(beta.core)</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>betamulti <span class="ot">&lt;-</span> <span class="fu">beta.multi.abund</span>(beta.core)</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a><span class="co">#turnover component</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>betamulti<span class="sc">$</span>beta.BRAY.BAL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7726223</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#nestedness component</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>betamulti<span class="sc">$</span>beta.BRAY.GRA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1070712</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#combined</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>betamulti<span class="sc">$</span>beta.BRAY</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8796935</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mostly turnover, some nestedness</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#betapair are dist objects</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>tdis <span class="ot">&lt;-</span> betapair<span class="sc">$</span>beta.bray.bal</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>ndis <span class="ot">&lt;-</span> betapair<span class="sc">$</span>beta.bray.gra</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>bdis <span class="ot">&lt;-</span> betapair<span class="sc">$</span>beta.bray</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co">#let's use the standardized environmental variables from the pca scores</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>envbeta <span class="ot">&lt;-</span> <span class="fu">cbind</span>(env.reduce, env2_sitelabels)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co">#sort envbeta to same order as site_species</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>envbeta <span class="ot">&lt;-</span> envbeta[<span class="fu">order</span>(<span class="fu">match</span>(envbeta[,<span class="dv">10</span>], <span class="fu">row.names</span>(sites_species))),]</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(envbeta) <span class="ot">&lt;-</span> envbeta<span class="sc">$</span>env2_sitelabels</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>envbeta <span class="ot">&lt;-</span> <span class="fu">select</span>(envbeta, <span class="sc">-</span>env2_sitelabels)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>env_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(envbeta, <span class="st">"euclidean"</span>)</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(tdis, env_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mantel statistic based on Pearson's product-moment correlation 

Call:
mantel(xdis = tdis, ydis = env_dist) 

Mantel statistic r: 0.08226 
      Significance: 0.135 

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0938 0.1259 0.1513 0.1808 
Permutation: free
Number of permutations: 999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(ndis, env_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mantel statistic based on Pearson's product-moment correlation 

Call:
mantel(xdis = ndis, ydis = env_dist) 

Mantel statistic r: 0.1643 
      Significance: 0.027 

Upper quantiles of permutations (null model):
  90%   95% 97.5%   99% 
0.105 0.136 0.166 0.196 
Permutation: free
Number of permutations: 999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mantel</span>(bdis, env_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mantel statistic based on Pearson's product-moment correlation 

Call:
mantel(xdis = bdis, ydis = env_dist) 

Mantel statistic r: 0.262 
      Significance: 0.002 

Upper quantiles of permutations (null model):
   90%    95%  97.5%    99% 
0.0891 0.1161 0.1416 0.1812 
Permutation: free
Number of permutations: 999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bdis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4784729</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(bdis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1532665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#turnover NOT related to env gradient</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#nestedness - this is changes to abundance is related</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="phylogenetic-signal" class="level2">
<h2 class="anchored" data-anchor-id="phylogenetic-signal">Phylogenetic signal</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("phytools")</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("picante")</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phytools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'phytools' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maps</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'phytools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:vegan':

    scores</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>genusv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cyphomyrmex"</span>, <span class="st">"Dorymyrmex"</span>, <span class="st">"Forelius"</span>, <span class="st">"Messor"</span>, <span class="st">"Myrmecocystus"</span>, <span class="st">"Pheidole"</span>, <span class="st">"Pogonomyrmex"</span>, <span class="st">"Solenopsis"</span>, <span class="st">"Temnothorax"</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#import nexus tree</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">read.nexus</span>(<span class="st">"moreau/moreaubeast.nex"</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ edge       : int [1:550, 1:2] 277 278 279 280 281 282 283 284 285 286 ...
 $ edge.length: num [1:550] 31.17 8.86 16.31 12.32 13.82 ...
 $ Nnode      : int 275
 $ tip.label  : chr [1:276] "Eutetramorium_sp._CSM" "Proatta_butteli_CSM" "Lophomyrmex_striatulus_CSM" "Mayriella_transfuga_CSM" ...
 - attr(*, "class")= chr "phylo"
 - attr(*, "order")= chr "cladewise"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Phylogenetic tree with 276 tips and 275 internal nodes.

Tip labels:
  Eutetramorium_sp._CSM, Proatta_butteli_CSM, Lophomyrmex_striatulus_CSM, Mayriella_transfuga_CSM, Mayriella_ebbei, Dilobocondyla_sp._CSM, ...

Rooted; includes branch lengths.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> tree[[<span class="st">"tip.label"</span>]]</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(labels)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> labels<span class="sc">$</span>labels</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">separate_wider_delim</span>(labels, <span class="at">cols =</span> <span class="dv">1</span>, <span class="at">delim =</span><span class="st">"_"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"genus"</span>, <span class="st">"sp"</span>, <span class="st">"csm"</span>), <span class="at">too_few =</span> <span class="st">"align_start"</span>, <span class="at">too_many =</span> <span class="st">"merge"</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">cbind</span>(full, labels)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">subset</span>(labels, genus <span class="sc">%in%</span> genusv)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> labels<span class="sc">$</span>full</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">19</span>, <span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> keep</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">is.na</span>(df)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(df, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>)</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>pruned <span class="ot">&lt;-</span> <span class="fu">prune.sample</span>(df, tree)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>pruned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Phylogenetic tree with 11 tips and 10 internal nodes.

Tip labels:
  Temnothorax_tricarinatus_CSM, Pheidole_hyatti, Cyphomyrmex_sp._CSM, Solenopsis_xyloni, Messor_julianus_CSM, Messor_andrei, ...

Rooted; includes branch lengths.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>pruned[[<span class="st">"tip.label"</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Temnothoraxandrei"</span>, <span class="st">"Pheidolehyatti"</span>, <span class="st">"Cyphomyrmexwheeleri"</span>, <span class="st">"Solenopsisxyloni"</span>, <span class="st">"Messorandrei"</span>, <span class="st">"Messorpergandei"</span>, <span class="st">"Pogonomyrmexcalifornicus"</span>, <span class="st">"Myrmecocystus"</span>, <span class="st">"Dorymyrmexbicolor"</span>, <span class="st">"Dorymyrmexinsanus"</span>, <span class="st">"Foreliuspruinosis"</span>) </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pruned)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>labelorder <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Temnothoraxandrei"</span>, <span class="st">"Pheidolehyatti"</span>, <span class="st">"Cyphomyrmexwheeleri"</span>, <span class="st">"Solenopsisxyloni"</span>, <span class="st">"Messorandrei"</span>, <span class="st">"Messorpergandei"</span>, <span class="st">"Pogonomyrmexcalifornicus"</span>, <span class="st">"Myrmecocystus"</span>, <span class="st">"Dorymyrmexbicolor"</span>, <span class="st">"Dorymyrmexinsanus"</span>, <span class="st">"Foreliuspruinosis"</span>) </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#get species level trait values</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>traits.sp1 <span class="ot">&lt;-</span> traits.sp <span class="sc">%&gt;%</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.,<span class="sc">-</span>sd) <span class="sc">%&gt;%</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Trait, <span class="at">values_from =</span> mean) <span class="sc">%&gt;%</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(traits.sp)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>traits.sp1 <span class="ot">&lt;-</span> <span class="fu">select</span>(traits.sp1, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">14</span>)</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>traits.sp1<span class="sc">$</span>X<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"."</span>, traits.sp1<span class="sc">$</span>X<span class="fl">.1</span>)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>traitphy <span class="ot">&lt;-</span> traits.sp1</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(traitphy) <span class="ot">&lt;-</span> traitphy<span class="sc">$</span>X<span class="fl">.1</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>traitphy <span class="ot">&lt;-</span> <span class="fu">select</span>(traitphy, <span class="sc">-</span>X<span class="fl">.1</span>)</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="st">"Temnothoraxandrei"</span>, <span class="st">"Pheidolehyatti"</span>, <span class="st">"Cyphomyrmexwheeleri"</span>, <span class="st">"Solenopsisxyloni"</span>, <span class="st">"Messorandrei"</span>, <span class="st">"Messorpergandei"</span>, <span class="st">"Pogonomyrmexcalifornicus"</span>, <span class="st">"Myrmecocystus"</span>, <span class="st">"Dorymyrmexbicolor"</span>, <span class="st">"Dorymyrmexinsanus"</span>, <span class="st">"Foreliuspruinosis"</span>) )</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(traitphy) <span class="ot">&lt;-</span> names</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>traitphy <span class="ot">&lt;-</span> traitphy[<span class="fu">match</span>(labelorder, <span class="fu">row.names</span>(traitphy)),]</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(traitphy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Temnothoraxandrei"        "Pheidolehyatti"          
 [3] "Cyphomyrmexwheeleri"      "Solenopsisxyloni"        
 [5] "Messorandrei"             "Messorpergandei"         
 [7] "Pogonomyrmexcalifornicus" "Myrmecocystus"           
 [9] "Dorymyrmexbicolor"        "Dorymyrmexinsanus"       
[11] "Foreliuspruinosis"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>pruned[[<span class="st">"tip.label"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Temnothoraxandrei"        "Pheidolehyatti"          
 [3] "Cyphomyrmexwheeleri"      "Solenopsisxyloni"        
 [5] "Messorandrei"             "Messorpergandei"         
 [7] "Pogonomyrmexcalifornicus" "Myrmecocystus"           
 [9] "Dorymyrmexbicolor"        "Dorymyrmexinsanus"       
[11] "Foreliuspruinosis"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(traitphy)) {</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pruned, <span class="at">show.tip.label=</span><span class="cn">FALSE</span>, <span class="at">main=</span>i)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch=</span><span class="dv">22</span>, <span class="at">col=</span>traitphy[,i]<span class="sc">+</span><span class="dv">1</span>, <span class="at">bg=</span>traitphy[,i]<span class="sc">+</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multiPhylosignal</span>(traitphy, pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   K PIC.variance.obs PIC.variance.rnd.mean PIC.variance.P
Eyel.w     0.2532986     3.742133e-05          4.606514e-05          0.524
Femur.w    0.5584242     3.399395e-04          9.856399e-04          0.137
Headl.w    0.5113930     1.282826e-04          3.328148e-04          0.134
Headw.w    0.8046833     1.277059e-04          5.185482e-04          0.040
Mandible.w 0.5146835     6.169524e-05          1.599992e-04          0.141
Scape.w    0.5003158     3.265117e-04          8.347862e-04          0.175
Webers     0.5805852     5.486835e-03          1.603504e-02          0.153
           PIC.variance.Z
Eyel.w         -0.2633894
Femur.w        -0.8945010
Headl.w        -0.8562493
Headw.w        -0.8868699
Mandible.w     -0.8098949
Scape.w        -0.7703697
Webers         -0.9193143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">multiPhylosignal</span>(traitphy, pruned)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ps, <span class="st">"Clean Data/phylo.csv"</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>ps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   K PIC.variance.obs PIC.variance.rnd.mean PIC.variance.P
Eyel.w     0.2532986     3.742133e-05          4.709071e-05          0.498
Femur.w    0.5584242     3.399395e-04          9.954752e-04          0.143
Headl.w    0.5113930     1.282826e-04          3.316720e-04          0.145
Headw.w    0.8046833     1.277059e-04          5.450904e-04          0.027
Mandible.w 0.5146835     6.169524e-05          1.590812e-04          0.166
Scape.w    0.5003158     3.265117e-04          8.159558e-04          0.204
Webers     0.5805852     5.486835e-03          1.623946e-02          0.149
           PIC.variance.Z
Eyel.w         -0.2876508
Femur.w        -0.8963552
Headl.w        -0.8694340
Headw.w        -0.9438506
Mandible.w     -0.8030385
Scape.w        -0.7370164
Webers         -0.9200552</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adephylo)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phylosignal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'phylosignal' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'phylosignal'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lattice':

    dotplot</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phylobase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'phylobase'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:phytools':

    readNexus</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ape':

    edges</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>p4d <span class="ot">&lt;-</span> <span class="fu">phylo4d</span>(pruned, traitphy)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot.phylo4d</span>(p4d, <span class="at">tree.type =</span> <span class="st">"phylo"</span>, <span class="at">tree.ladderize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">phyloSignal</span>(<span class="at">p4d =</span> p4d, <span class="at">method =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$stat
                 Cmean           I         K    K.star       Lambda
Eyel.w      0.02557409  0.08942027 0.2532986 0.2596278 9.740407e-02
Femur.w    -0.09055732 -0.06563768 0.5584242 0.5717154 6.790197e-05
Headl.w    -0.19542566 -0.13060100 0.5113930 0.5241054 6.790197e-05
Headw.w    -0.02133032 -0.06810060 0.8046833 0.8248318 1.026769e+00
Mandible.w -0.19836630 -0.14149397 0.5146835 0.5263125 6.790197e-05
Scape.w    -0.19528600 -0.03013315 0.5003158 0.5123065 6.790197e-05
Webers      0.29106194  0.11197731 0.5805852 0.5949963 7.199164e-01

$pvalue
           Cmean     I     K K.star     Lambda
Eyel.w     0.229 0.106 0.492  0.496 0.78447533
Femur.w    0.408 0.399 0.144  0.136 1.00000000
Headl.w    0.661 0.580 0.127  0.149 1.00000000
Headw.w    0.311 0.359 0.045  0.036 0.02868054
Mandible.w 0.707 0.640 0.147  0.160 1.00000000
Scape.w    0.673 0.286 0.197  0.190 1.00000000
Webers     0.032 0.097 0.150  0.155 0.31989075</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>sespd <span class="ot">&lt;-</span> <span class="fu">ses.pd</span>(sites_species, pruned, <span class="at">null.model =</span> <span class="st">"independentswap"</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>pdist <span class="ot">&lt;-</span> <span class="fu">cophenetic.phylo</span>(pruned)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>ses.mpd.result <span class="ot">&lt;-</span> <span class="fu">ses.mpd</span>(sites_species, pdist, <span class="at">null.model=</span><span class="st">"independentswap"</span>, <span class="at">abundance.weighted=</span><span class="cn">TRUE</span>, <span class="at">runs=</span><span class="dv">99</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>ses.mpd.result<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">row.names</span>(ses.mpd.result)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">left_join</span>(SES2, ses.mpd.result, <span class="at">by =</span> <span class="st">"sites"</span>)</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(SES3 <span class="sc">~</span> mpd.obs.z <span class="sc">+</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Site), <span class="at">data =</span> test)</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          SES3 ~ mpd.obs.z + PC1 + PC2 + (1 | Site)
Data: test

     AIC      BIC   logLik deviance df.resid 
    67.9     75.6    -27.9     55.9       21 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev. 
 Site     (Intercept) 4.005e-09 6.328e-05
 Residual             4.635e-01 6.808e-01
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.463 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.5996     0.1312   4.569 4.91e-06 ***
mpd.obs.z     0.2330     0.1050   2.220  0.02644 *  
PC1          -0.5276     0.1743  -3.027  0.00247 ** 
PC2          -0.2179     0.1751  -1.245  0.21322    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC    |   AICc |    BIC | R2 (cond.) | R2 (marg.) |  RMSE | Sigma
------------------------------------------------------------------
67.858 | 72.058 | 75.633 |            |      0.357 | 0.681 | 0.681</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(mpd.obs.z <span class="sc">~</span> SES3 <span class="sc">+</span> PC1 <span class="sc">+</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), <span class="at">data =</span> test)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          mpd.obs.z ~ SES3 + PC1 + PC2 + (1 | Site)
Data: test

     AIC      BIC   logLik deviance df.resid 
    94.3    102.1    -41.2     82.3       21 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.6875   0.8291  
 Residual             0.8094   0.8997  
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.809 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  -0.5062     0.3620  -1.398  0.16200   
SES3          0.7447     0.2696   2.762  0.00575 **
PC1           0.3084     0.4459   0.692  0.48922   
PC2          -0.2232     0.5040  -0.443  0.65787   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC    |   AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
---------------------------------------------------------------------------
94.312 | 98.512 | 102.087 |      0.572 |      0.208 | 0.459 | 0.785 | 0.900</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(test<span class="sc">$</span>mpd.obs.z, test<span class="sc">$</span>PC1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  test$mpd.obs.z and test$PC1
t = 0.26919, df = 25, p-value = 0.79
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.3330587  0.4250891
sample estimates:
       cor 
0.05375942 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(test<span class="sc">$</span>mpd.obs.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  test$mpd.obs.z
t = -0.29309, df = 26, p-value = 0.7718
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.5790630  0.4345396
sample estimates:
  mean of x 
-0.07226169 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test, <span class="fu">aes</span>(SES3, mpd.obs.z)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test, <span class="fu">aes</span>(PC1, mpd.obs.z)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(test, <span class="fu">aes</span>(PC1, SES3)) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>Test.Kmult<span class="ot">&lt;-</span><span class="cf">function</span>(x,phy,<span class="at">iter=</span><span class="dv">999</span>){</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>Kmult<span class="ot">&lt;-</span><span class="cf">function</span>(x,phy){</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">length</span>(phy<span class="sc">$</span>tip.label)</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  ones<span class="ot">&lt;-</span><span class="fu">array</span>(<span class="dv">1</span>,N)</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  C<span class="ot">&lt;-</span><span class="fu">vcv.phylo</span>(phy)</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>  C<span class="ot">&lt;-</span>C[<span class="fu">row.names</span>(x),<span class="fu">row.names</span>(x)]</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  a.obs<span class="ot">&lt;-</span><span class="fu">colSums</span>(<span class="fu">solve</span>(C))<span class="sc">%*%</span>x<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">solve</span>(C))</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a><span class="co">#evol.vcv code</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>  distmat<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">rbind</span>(<span class="fu">as.matrix</span>(x),a.obs)))</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>  MSEobs.d <span class="ot">&lt;-</span> <span class="fu">sum</span>(distmat[(<span class="dv">1</span><span class="sc">:</span>N),(N<span class="sc">+</span><span class="dv">1</span>)]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sum distances root vs. tips</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>  eigC <span class="ot">&lt;-</span> <span class="fu">eigen</span>(C)</span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>  D.mat<span class="ot">&lt;-</span><span class="fu">solve</span>(eigC<span class="sc">$</span>vectors</span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(eigC<span class="sc">$</span>values))</span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">%*%</span> <span class="fu">t</span>(eigC<span class="sc">$</span>vectors))</span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>  dist.adj<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">rbind</span>((D.mat</span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">%*%</span>(x<span class="sc">-</span>(ones<span class="sc">%*%</span>a.obs))),<span class="dv">0</span>)))</span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>  MSE.d<span class="ot">&lt;-</span><span class="fu">sum</span>(dist.adj[(<span class="dv">1</span><span class="sc">:</span>N),(N<span class="sc">+</span><span class="dv">1</span>)]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#sum distances for transformed data)</span></span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>  K.denom<span class="ot">&lt;-</span>(<span class="fu">sum</span>(<span class="fu">diag</span>(C))<span class="sc">-</span></span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>  N<span class="sc">*</span><span class="fu">solve</span>(<span class="fu">t</span>(ones)<span class="sc">%*%</span><span class="fu">solve</span>(C)<span class="sc">%*%</span>ones)) <span class="sc">/</span> (N<span class="dv">-1</span>)</span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>  K.stat<span class="ot">&lt;-</span>(MSEobs.d<span class="sc">/</span>MSE.d)<span class="sc">/</span>K.denom</span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(K.stat)</span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>K.obs<span class="ot">&lt;-</span><span class="fu">Kmult</span>(x,phy)</span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>P.val <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a>K.val <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, iter)</span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter){</span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a>x.r<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x[<span class="fu">sample</span>(<span class="fu">nrow</span>(x)),])</span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(x.r)<span class="ot">&lt;-</span><span class="fu">rownames</span>(x)</span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>K.rand<span class="ot">&lt;-</span><span class="fu">Kmult</span>(x.r,phy)</span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a>P.val<span class="ot">&lt;-</span><span class="fu">ifelse</span>(K.rand<span class="sc">&gt;=</span>K.obs, P.val<span class="sc">+</span><span class="dv">1</span>,P.val)</span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a>K.val[i] <span class="ot">&lt;-</span> K.rand</span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a>P.val <span class="ot">&lt;-</span> P.val<span class="sc">/</span>(iter <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a>K.val[iter <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">=</span> K.obs</span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(K.val, <span class="dv">30</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"gray"</span>,</span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"Phylogenetic Signal"</span>)</span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(K.obs, <span class="dv">50</span>, K.obs, <span class="dv">5</span>, <span class="at">length =</span> <span class="fl">0.1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">phy.signal =</span> K.obs, <span class="at">pvalue =</span> P.val))</span>
<span id="cb166-44"><a href="#cb166-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb166-45"><a href="#cb166-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-46"><a href="#cb166-46" aria-hidden="true" tabindex="-1"></a>traitphystand <span class="ot">&lt;-</span> <span class="fu">decostand</span>(traitphy, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb166-47"><a href="#cb166-47" aria-hidden="true" tabindex="-1"></a><span class="fu">Test.Kmult</span>(traitphystand, pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-17-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$phy.signal
          [,1]
[1,] 0.4794483

$pvalue
      [,1]
[1,] 0.008</code></pre>
</div>
</div>
</section>
<section id="phylo-and-functional-plots-together" class="level2">
<h2 class="anchored" data-anchor-id="phylo-and-functional-plots-together">Phylo and functional plots together</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(test, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"SES3"</span>, <span class="st">"mpd.obs.z"</span>), <span class="at">names_to =</span> <span class="st">"type"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>test2<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(test2<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SES3"</span>, <span class="st">"mpd.obs.z"</span>))</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(test2, <span class="fu">aes</span>(PC1, value, <span class="at">color =</span> type)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> type)) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">data =</span> <span class="fu">filter</span>(test2, type <span class="sc">==</span> <span class="st">"SES3"</span>), <span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">data =</span> <span class="fu">filter</span>(test2, type <span class="sc">==</span> <span class="st">"mpd.obs.z"</span>), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Standardized Effect Size Dispersion"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>( <span class="st">"#DF7861"</span>, <span class="st">"#94B49F"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Functional"</span>, <span class="st">"Phylogenetic"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title=</span><span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(test, <span class="fu">aes</span>(mpd.obs.z, SES3)) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">NA</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Phylogenetic Dispersion (SES MPD)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Functional Dispersion (SES FDisp)"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>(a,b)</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>widths <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots)){</span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>    grobs[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plots[[i]])</span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a>    widths[[i]] <span class="ot">&lt;-</span> grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>maxwidth <span class="ot">&lt;-</span> <span class="fu">do.call</span>(grid<span class="sc">::</span>unit.pmax, widths)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grobs)){</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>     grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.list</span>(maxwidth)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"grid.arrange"</span>, <span class="fu">c</span>(grobs, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (1 x 2) "arrange": 2 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="dv">2</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Adj r2 = "</span>,<span class="fu">signif</span>(<span class="fu">summary</span>(fit1)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>),</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a> <span class="st">" </span><span class="sc">\n</span><span class="st">P ="</span>,<span class="fu">signif</span>(<span class="fu">summary</span>(fit1)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">4</span>], <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mapping: x = 0.75, y = 2 
geom_label: parse = FALSE, label.padding = 0.25, label.r = 0.15, label.size = 0.25, na.rm = FALSE
stat_identity: na.rm = FALSE
position_identity </code></pre>
</div>
</div>
</section>
<section id="variance-partitioning" class="level2">
<h2 class="anchored" data-anchor-id="variance-partitioning">Variance partitioning</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(adespatial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'adegraphics':
  method         from
  biplot.dudi    ade4
  kplot.foucart  ade4
  kplot.mcoa     ade4
  kplot.mfa      ade4
  kplot.pta      ade4
  kplot.sepan    ade4
  kplot.statis   ade4
  scatter.coa    ade4
  scatter.dudi   ade4
  scatter.nipals ade4
  scatter.pco    ade4
  score.acm      ade4
  score.mix      ade4
  score.pca      ade4
  screeplot.dudi ade4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'spdep':
  method   from
  plot.mst ape </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'adespatial':
  method             from       
  plot.multispati    adegraphics
  print.multispati   ade4       
  summary.multispati ade4       </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'adespatial'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ade4':

    multispati</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SoDA)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co">#convert our degrees in lat long to cartesian</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>sites.xy <span class="ot">&lt;-</span> <span class="fu">geoXY</span>(SES2<span class="sc">$</span>Lat.x, SES2<span class="sc">$</span>Long.x)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>mem <span class="ot">&lt;-</span> <span class="fu">dbmem</span>(sites.xy)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> SES2<span class="sc">$</span>SES3</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">select</span>(SES2, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">24</span>)</span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">decostand</span>(env, <span class="at">method =</span> <span class="st">"standardize"</span>)</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>pses <span class="ot">&lt;-</span> test<span class="sc">$</span>mpd.obs.z</span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">varpart</span>(<span class="at">Y =</span>disp, <span class="at">X =</span> env, mem, pses)</span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(v1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Unique fractions and total with shared fractions equally allocated:

   Unique Contributed Component
X1  0.265       0.386       env
X2  0.216       0.267       mem
X3  0.325       0.190      pses

Contributions of fractions to sets:

           X1        X2        X3
[a]  0.265150                    
[b]            0.215583          
[c]                      0.325427
[d]  0.153661  0.153661          
[e]           -0.103081 -0.103081
[f] -0.033342           -0.033342
[g]  0.000576  0.000576  0.000576</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v1, <span class="at">Xnames =</span> <span class="cn">NA</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">"Environment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Partition of variance in RDA 

Call: varpart(Y = disp, X = env, mem, pses)

Explanatory tables:
X1:  env
X2:  mem
X3:  pses 

No. of explanatory tables: 3 
Total variation (SS): 19.198 
            Variance: 0.73839 
No. of observations: 27 

Partition table:
                      Df R.square Adj.R.square Testable
[a+d+f+g] = X1         9  0.67799      0.50752     TRUE
[b+d+e+g] = X2         3  0.39711      0.31847     TRUE
[c+e+f+g] = X3         1  0.09068      0.05431     TRUE
[a+b+d+e+f+g] = X1+X2 12  0.73989      0.51694     TRUE
[a+c+d+e+f+g] = X1+X3 10  0.77033      0.62678     TRUE
[b+c+d+e+f+g] = X2+X3  4  0.64226      0.57722     TRUE
[a+b+c+d+e+f+g] = All 13  0.92118      0.84237     TRUE
Individual fractions                                   
[a] = X1 | X2+X3       9               0.26515     TRUE
[b] = X2 | X1+X3       3               0.21558     TRUE
[c] = X3 | X1+X2       1               0.32543     TRUE
[d]                    0               0.30732    FALSE
[e]                    0              -0.20616    FALSE
[f]                    0              -0.06668    FALSE
[g]                    0               0.00173    FALSE
[h] = Residuals                        0.15763    FALSE
Controlling 1 table X                                  
[a+d] = X1 | X3        9               0.57247     TRUE
[a+f] = X1 | X2        9               0.19847     TRUE
[b+d] = X2 | X3        3               0.52291     TRUE
[b+e] = X2 | X1        3               0.00942     TRUE
[c+e] = X3 | X1        1               0.11927     TRUE
[c+f] = X3 | X2        1               0.25874     TRUE
---
Use function 'rda' to test significance of fractions of interest</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fract <span class="ot">&lt;-</span> v1<span class="sc">$</span>part<span class="sc">$</span>fract</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> v1<span class="sc">$</span>part<span class="sc">$</span>indfract</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#CWM-environment ## CWM ~ PC1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>site_cwm <span class="ot">&lt;-</span> <span class="fu">dbFD</span>(trait.pop, wide.pop, <span class="at">w.abun =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>CWM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FEVe: Could not be calculated for communities with &lt;3 functionally singular species. 
FRic: To respect s &gt; t, FRic could not be calculated for communities with &lt;3 functionally singular species. 
FRic: Dimensionality reduction was required. The last 5 PCoA axes (out of 7 in total) were removed. 
FRic: Quality of the reduced-space representation = 0.6807776 
FDiv: Could not be calculated for communities with &lt;3 functionally singular species. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>cwm <span class="ot">&lt;-</span> site_cwm</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>cwm<span class="sc">$</span>sites <span class="ot">&lt;-</span> <span class="fu">row.names</span>(cwm)  </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>cwm <span class="ot">&lt;-</span> <span class="fu">select</span>(SES2, Site, sites, PC1, PC2) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(cwm, <span class="at">by =</span> <span class="st">'sites'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Webers <span class="sc">~</span> PC1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Webers ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -30.1    -24.9     19.0    -38.1       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0005269 0.02295 
 Residual             0.0137959 0.11746 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.0138 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.97834    0.02386   41.00  &lt; 2e-16 ***
PC1         -0.10159    0.03189   -3.19  0.00144 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------
-30.052 | -28.234 | -24.869 |      0.324 |      0.298 | 0.037 | 0.115 | 0.117</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit2)</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit2<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit2<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit2<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">1.4</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM Weber's </span><span class="sc">\n</span><span class="st">Body Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
â„¹ Please use tidy evaluation idioms with `aes()`.
â„¹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Femur.w <span class="sc">~</span> PC1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Femur.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -96.7    -91.5     52.3   -104.7       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0002092 0.01446 
 Residual             0.0010348 0.03217 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.00103 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.984074   0.007847  125.41   &lt;2e-16 ***
PC1         -0.026377   0.010938   -2.41   0.0159 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">1.1</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Femur Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Headl.w <span class="sc">~</span> PC1<span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Headl.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -126.5   -121.4     67.3   -134.5       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0001759 0.01326 
 Residual             0.0002825 0.01681 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000282 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.820070   0.005478  149.70   &lt;2e-16 ***
PC1         -0.001399   0.007394   -0.19     0.85    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.86</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Head Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Eyel.w <span class="sc">~</span> PC1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Eyel.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -155.1   -149.9     81.6   -163.1       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 7.723e-05 0.008788
 Residual             9.146e-05 0.009563
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 9.15e-05 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.166355   0.003460   48.09   &lt;2e-16 ***
PC1         0.002873   0.004589    0.63    0.531    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Eye Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Headw.w <span class="sc">~</span> PC1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Headw.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -116.0   -110.8     62.0   -124.0       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0004533 0.02129 
 Residual             0.0003491 0.01869 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000349 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.740925   0.007956   93.13   &lt;2e-16 ***
PC1         -0.002018   0.010420   -0.19    0.846    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.8</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Head Width (mm)"</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Scape.w <span class="sc">~</span> PC1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Scape.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -82.6    -77.5     45.3    -90.6       23 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.001544 0.03929 
 Residual             0.001206 0.03473 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.00121 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.768365   0.014703   52.26   &lt;2e-16 ***
PC1         -0.005763   0.021260   -0.27    0.786    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.85</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Scape Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Mandible.w <span class="sc">~</span> PC1<span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Mandible.w ~ PC1 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -141.6   -136.4     74.8   -149.6       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0001323 0.01150 
 Residual             0.0001490 0.01221 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000149 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.445969   0.004496   99.19   &lt;2e-16 ***
PC1         -0.003474   0.005745   -0.60    0.545    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.5</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Mandible Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-7.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>(a,b,c,d,e,f,g)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>widths <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots)){</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>    grobs[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plots[[i]])</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>    widths[[i]] <span class="ot">&lt;-</span> grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>maxwidth <span class="ot">&lt;-</span> <span class="fu">do.call</span>(grid<span class="sc">::</span>unit.pmax, widths)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grobs)){</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>     grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.list</span>(maxwidth)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"grid.arrange"</span>, <span class="fu">c</span>(grobs, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (4 x 2) "arrange": 7 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]
3 3 (2-2,1-1) arrange gtable[layout]
4 4 (2-2,2-2) arrange gtable[layout]
5 5 (3-3,1-1) arrange gtable[layout]
6 6 (3-3,2-2) arrange gtable[layout]
7 7 (4-4,1-1) arrange gtable[layout]</code></pre>
</div>
</div>
</section>
<section id="cwm-pc2" class="level2">
<h2 class="anchored" data-anchor-id="cwm-pc2">CWM ~ PC2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Webers <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Webers ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -24.6    -19.4     16.3    -32.6       23 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 Site     (Intercept) 0.006141 0.07837 
 Residual             0.013048 0.11423 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.013 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.97834    0.03414  28.655   &lt;2e-16 ***
PC2          0.03600    0.03856   0.934     0.35    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------
-24.610 | -22.792 | -19.426 |      0.346 |      0.038 | 0.320 | 0.102 | 0.114</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">1.3</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM Weber's </span><span class="sc">\n</span><span class="st">Body Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Femur.w <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Femur.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -97.0    -91.8     52.5   -105.0       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0009476 0.03078 
 Residual             0.0006969 0.02640 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000697 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.98407    0.01145   85.95   &lt;2e-16 ***
PC2          0.02150    0.01064    2.02   0.0432 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------
-97.012 | -95.194 | -91.828 |      0.636 |      0.142 | 0.576 | 0.023 | 0.026</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">1.1</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Femur Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Headl.w <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Headl.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -130.4   -125.2     69.2   -138.4       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0001528 0.01236 
 Residual             0.0002444 0.01563 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000244 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.820070   0.005102  160.72   &lt;2e-16 ***
PC2         -0.011191   0.005474   -2.04   0.0409 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
-130.422 | -128.604 | -125.239 |      0.481 |      0.156 | 0.385 | 0.014 | 0.016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.9</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>)  <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Head Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Eyel.w <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Eyel.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -154.7   -149.5     81.4   -162.7       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 7.456e-05 0.008635
 Residual             9.429e-05 0.009711
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 9.43e-05 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.1663546  0.0034318   48.47   &lt;2e-16 ***
PC2         0.0002098  0.0037662    0.06    0.956    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
-154.702 | -152.884 | -149.519 |      0.442 |  1.533e-04 | 0.442 | 0.008 | 0.010</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Eye Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Headw.w <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Headw.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -116.3   -111.2     62.2   -124.3       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0005339 0.02311 
 Residual             0.0003228 0.01797 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000323 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.740925   0.008443   87.76   &lt;2e-16 ***
PC2         -0.005258   0.008349   -0.63    0.529    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
-116.350 | -114.531 | -111.166 |      0.630 |      0.019 | 0.623 | 0.015 | 0.018</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">0.8</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Head Width (mm)"</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>e</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Scape.w <span class="sc">~</span> PC2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Scape.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
   -85.7    -80.5     46.9    -93.7       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 0.0026028 0.05102 
 Residual             0.0008359 0.02891 
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000836 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.76836    0.01789   42.94   &lt;2e-16 ***
PC2          0.02669    0.01377    1.94   0.0526 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------
-85.702 | -83.884 | -80.519 |      0.783 |      0.109 | 0.757 | 0.024 | 0.029</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">model_performance</span>(fit1)</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">0.85</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Scape Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Mandible.w <span class="sc">~</span> PC2  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Site), cwm)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          Mandible.w ~ PC2 + (1 | Site)
Data: cwm

     AIC      BIC   logLik deviance df.resid 
  -143.0   -137.9     75.5   -151.0       23 

Random effects:

Conditional model:
 Groups   Name        Variance  Std.Dev.
 Site     (Intercept) 7.941e-05 0.008911
 Residual             1.609e-04 0.012684
Number of obs: 27, groups:  Site, 9

Dispersion estimate for gaussian family (sigma^2): 0.000161 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.445969   0.003845  115.99   &lt;2e-16 ***
PC2         0.006741   0.004867    1.39    0.166    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
-143.040 | -141.221 | -137.856 |      0.398 |      0.100 | 0.330 | 0.011 | 0.013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fit1<span class="sc">$</span>frame, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">2</span>], <span class="at">y =</span> <span class="fu">names</span>(fit1<span class="sc">$</span>frame)[<span class="dv">1</span>])) <span class="sc">+</span> </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"#3C4142"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> <span class="fl">0.5</span>),<span class="at">vjust=</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Marginal </span><span class="sc">\n</span><span class="st">r2 = "</span>,<span class="fu">signif</span>(t<span class="sc">$</span>R2_marginal, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"CWM </span><span class="sc">\n</span><span class="st">Mandible Length (mm)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"PC2"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>))  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.margin=</span>grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="st">"mm"</span>))<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">19</span>))</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-7.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>(a,b,c,d,e,f,g)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>widths <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots)){</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>    grobs[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplotGrob</span>(plots[[i]])</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>    widths[[i]] <span class="ot">&lt;-</span> grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>maxwidth <span class="ot">&lt;-</span> <span class="fu">do.call</span>(grid<span class="sc">::</span>unit.pmax, widths)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grobs)){</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>     grobs[[i]]<span class="sc">$</span>widths[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.list</span>(maxwidth)</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"grid.arrange"</span>, <span class="fu">c</span>(grobs, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (4 x 2) "arrange": 7 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]
3 3 (2-2,1-1) arrange gtable[layout]
4 4 (2-2,2-2) arrange gtable[layout]
5 5 (3-3,1-1) arrange gtable[layout]
6 6 (3-3,2-2) arrange gtable[layout]
7 7 (4-4,1-1) arrange gtable[layout]</code></pre>
</div>
</div>
</section>
</section>
<section id="itv" class="level1">
<h1>ITV</h1>
<p>Intraspecific trait variation</p>
<section id="body-size" class="level2">
<h2 class="anchored" data-anchor-id="body-size">Body size</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>itv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="co">#body size</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>webers <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Webers"</span>)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> webers)</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10  52.89   5.289   295.8 &lt;2e-16 ***
Residuals   252   4.51   0.018                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is a low component of overall variability</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>logWebers <span class="ot">&lt;-</span> <span class="fu">log</span>(webers<span class="sc">$</span>Measure)</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logWebers <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> webers, <span class="at">na.action =</span> na.omit)</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>varcompWeber <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>varcompWeber</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Site          X.1       Within 
2.839742e-09 9.079277e-01 9.207234e-02 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#body size differences between individuals of the same species within a site account for 9.2% variation</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 90.7%</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 0 %</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="femur-length" class="level2">
<h2 class="anchored" data-anchor-id="femur-length">Femur length</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relative leg length</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>femur <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Femur.w"</span>)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> femur)</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10  2.085 0.20850   43.34 &lt;2e-16 ***
Residuals   251  1.208 0.00481                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is 1.208/3.298 = 36.6% of variation</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>logFemur <span class="ot">&lt;-</span> <span class="fu">log</span>(femur<span class="sc">$</span>Measure)</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logFemur <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> femur, <span class="at">na.action =</span> na.omit)</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>varcompFemur <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>varcompFemur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Site        X.1     Within 
0.02389404 0.66474425 0.31136170 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co">#relative femur length differences between individuals of the same species within a site account for 31% variation</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 66.7%</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 2.4 %</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scape-length" class="level2">
<h2 class="anchored" data-anchor-id="scape-length">Scape length</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scape length</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>scape <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Scape.w"</span>)</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> scape)</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10  3.926  0.3926   139.6 &lt;2e-16 ***
Residuals   251  0.706  0.0028                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is 0.706/4.632 = 15.2 % of variation</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>logScape <span class="ot">&lt;-</span> <span class="fu">log</span>(scape<span class="sc">$</span>Measure)</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logScape <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> scape, <span class="at">na.action =</span> na.omit)</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>varcompScape <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>varcompScape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Site         X.1      Within 
5.04798e-10 8.44903e-01 1.55097e-01 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co">#relative scape length differences between individuals of the same species within a site account for 15% variation</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 84.5%</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 0%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mandible-length" class="level2">
<h2 class="anchored" data-anchor-id="mandible-length">Mandible length</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mandible length</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>mandible <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Mandible.w"</span>)</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> mandible)</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10 0.4122 0.04122   29.74 &lt;2e-16 ***
Residuals   251 0.3478 0.00139                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is 0.3478/0.76 = 45.7 % of variation</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>logMandible <span class="ot">&lt;-</span> <span class="fu">log</span>(mandible<span class="sc">$</span>Measure)</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logMandible <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> mandible, <span class="at">na.action =</span> na.omit)</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>varcompMandible <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>varcompMandible</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Site          X.1       Within 
1.246728e-09 6.336859e-01 3.663141e-01 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co">#relative mandible length differences between individuals of the same species within a site account for 36.6% variation</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 63%</span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 0%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eye-length" class="level2">
<h2 class="anchored" data-anchor-id="eye-length">Eye length</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co">#eye length</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>el <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Eyel.w"</span>)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> el)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df  Sum Sq  Mean Sq F value Pr(&gt;F)    
X.1          10 0.24415 0.024415   92.42 &lt;2e-16 ***
Residuals   251 0.06631 0.000264                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is 0.06/0.31 = 21 % of variation</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>logEL <span class="ot">&lt;-</span> <span class="fu">log</span>(el<span class="sc">$</span>Measure)</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logEL <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> el, <span class="at">na.action =</span> na.omit)</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>varcompEL <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>varcompEL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Site          X.1       Within 
9.171576e-10 7.595791e-01 2.404209e-01 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">#relative eye length differences between individuals of the same species within a site account for 24% variation</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 75.9%</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 0%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="head-width" class="level2">
<h2 class="anchored" data-anchor-id="head-width">Head width</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head width</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Headw.w"</span>)</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> hw)</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10 1.3930 0.13930    70.1 &lt;2e-16 ***
Residuals   251 0.4988 0.00199                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ITV is 26%</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fl">0.49</span><span class="sc">/</span>(<span class="fl">0.49+1.39</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2606383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>logHW <span class="ot">&lt;-</span> <span class="fu">log</span>(hw<span class="sc">$</span>Measure)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>modPart <span class="ot">&lt;-</span> <span class="fu">lme</span>(logHW <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Site <span class="sc">/</span> X<span class="fl">.1</span>, <span class="at">data =</span> hw, <span class="at">na.action =</span> na.omit)</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>varcompHW <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">varcomp</span>(modPart, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>varcompHW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Site          X.1       Within 
2.652055e-10 7.816622e-01 2.183378e-01 
attr(,"class")
[1] "varcomp"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co">#relative head width differences between individuals of the same species within a site account for 21.8% variation</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species within a site account for 78.1%</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="co">#differences among species between sites accounts for 0%</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>hl <span class="ot">&lt;-</span> traits <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Trait <span class="sc">==</span> <span class="st">"Headl.w"</span>)</span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">aov</span>(Measure<span class="sc">~</span>X<span class="fl">.1</span>, <span class="at">data =</span> hl)</span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(partition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
X.1          10 0.7752 0.07752   26.34 &lt;2e-16 ***
Residuals   251 0.7387 0.00294                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="itv-plots" class="level2">
<h2 class="anchored" data-anchor-id="itv-plots">ITV Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>itv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"raw data/itv.csv"</span>)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>itv <span class="ot">&lt;-</span> itv <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">total =</span> Species <span class="sc">+</span> ITV) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp.rel =</span> Species<span class="sc">/</span>total, <span class="at">itv.rel =</span> ITV<span class="sc">/</span>total)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>itv <span class="ot">=</span> <span class="fu">pivot_longer</span>(itv, <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">names_to =</span> <span class="st">"rel.itv"</span>, <span class="at">values_to =</span> <span class="st">"val"</span>)</span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Weber"</span>, <span class="st">"Weber's </span><span class="sc">\n</span><span class="st">Body Length"</span>, itv<span class="sc">$</span>Trait)</span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Femur"</span>, <span class="st">"Femur Length"</span>, itv<span class="sc">$</span>Trait)</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Mandible"</span>, <span class="st">"Mandible</span><span class="sc">\n</span><span class="st"> Length"</span>, itv<span class="sc">$</span>Trait)</span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Scape"</span>, <span class="st">"Scape Length"</span>, itv<span class="sc">$</span>Trait)</span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">factor</span>(itv<span class="sc">$</span>Trait, <span class="at">levels =</span> <span class="fu">unique</span>(itv<span class="sc">$</span>Trait[<span class="fu">order</span>(itv<span class="sc">$</span>val)]))</span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>itv<span class="sc">$</span>rel.itv <span class="ot">&lt;-</span> <span class="fu">factor</span>(itv<span class="sc">$</span>rel.itv, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sp.rel"</span>, <span class="st">"itv.rel"</span>))</span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>itv <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(rel.itv) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(val), <span class="at">sd =</span> <span class="fu">sd</span>(val))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 3
  rel.itv  mean    sd
  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 sp.rel  0.711 0.155
2 itv.rel 0.289 0.155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(itv, <span class="fu">aes</span>(Trait, val, <span class="at">fill =</span> rel.itv)) <span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">"stack"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> rel.itv)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Proportion of trait variation explained"</span>) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray"</span>, <span class="st">"black"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Interspecific"</span>, <span class="st">"Intraspecific"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>,<span class="at">face=</span><span class="st">"bold"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>