join.right <- right_join(traits.ag, long, by = c("Site", "species"))
CWM <- mutate(join.right, cwm.prod = mean*rel.abun)
CWM <- group_by(CWM, Site, uniID, Trait) %>% summarise(cwm = sum(cwm.prod))
ggplot(filter(CWM, Trait == "Webers"), aes(Site, cwm)) + geom_boxplot()
ggplot(filter(CWM, Trait == "Scape"), aes(Site, cwm)) + geom_boxplot()
m1 <- glm(cwm ~ Trait*Site, data = CWM)
summary(m1)
ggplot(filter(CWM, Trait == "Mandbile length"), aes(Site, cwm)) + geom_boxplot()
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm)) + geom_boxplot()
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Mandible length")
library(dplyr)
library(sf)
library(dplyr)
library(sf)
sites <- read.csv("Clean Data/sites_joined.csv")
sites <- st_read(sites)
site_sf <- st_as_sf(sites, coords = c("Long", "Lat"), crs = EPSG:4326)
site_sf <- st_as_sf(sites, coords = c("Long", "Lat"), crs = 4326)
plot(site_sf)
site_buf <- st_buffer(site_sf)
site_buf <- st_buffer(site_sf, dist = 50)
plot(site_buf)
View(site_buf)
st_write(site_sf, "Clean Data/sites.shp")
library(dplyr)
library(tidyr)
library(ggplot2)
library(performance)
library(glmmTMB)
wide <- read.csv("Clean Data/ants_wide.csv")
cov <- read.csv("Clean Data/ants.csv")
sites <- read.csv("Clean Data/sites_joined.csv")
cov <- right_join(sites, cov, by = c("Site", "month"))
cov <- dplyr::select(cov, 3:10, 14:19, 22:36, 39:41)
View(cov)
#add ecostress sensor data
eco <- read.csv("Clean Data/ecostress.csv")
View(cov)
View(eco)
eco <- select(eco, 1, 2, 11)
eco <- rename(eco, Site = Category)
View(cov)
#add ecostress sensor data
eco <- read.csv("Clean Data/ecostress.csv")
eco <- select(eco, 1, 2, 11)
eco <- rename(eco, month = Category, Site = ID, esi = ECO4ESIPTJPL_001_Evaporative_Stress_Index_PT_JPL_ESIavg)
cov <- right_join(eco, cov, by = c("Site", "month"))
View(cov)
traits <- read.csv("raw data/Traits.csv")
unique(traits$Trait)
traits <- separate(traits, Photo, c("Site", "Slide", "Specimen"))
traits$Site <- gsub("Papl", "PaPl", traits$Site)
unique(traits$Site)
traits <- traits[-1,]
traits.ag <- group_by(traits, Site, X.1, Trait) %>% summarise(mean = mean(Measure), sd = sd(Measure))
traits.sp <- group_by(traits, X.1, Trait) %>% summarise(mean = mean(Measure), sd = sd(Measure))
#calculate CWM trait values
#I want to do abundance
#it's proportional abundances
site.j <- select(cov, uniID, Site)
wide <- right_join(site.j, wide, by = "uniID")
wide <- select(wide, -X)
wide <- select(wide, -12, -13)
long <- pivot_longer(wide, 3:13, names_to = "species", values_to = "count")
long <- group_by(long, uniID) %>% mutate(total = sum(count))
long <- long %>% mutate(rel.abun = count/total)
traits.ag <- rename(traits.ag, species = X.1)
traits.ag$species <- gsub(" ", "", traits.ag$species)
#this adds NA traits to 0 abundances - species isn't found at pitfall or site
join.right <- right_join(traits.ag, long, by = c("Site", "species"))
#join.left <- left_join(traits.ag, long, by = c("Site", "species"))
CWM <- mutate(join.right, cwm.prod = mean*rel.abun)
CWM <- group_by(CWM, Site, uniID, Trait) %>% summarise(cwm = sum(cwm.prod))
#can log transform the abundances to look at dominants vs subordinates
View(CWM)
CWM <- left_join(CWM, cov, by = "uniID")
View(CWM)
ggplot(filter(CWM, Trait == "Mandible length"), aes(Microsite, cwm)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Microsite, cwm, fill = Site)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Microsite, cwm, fill = "Site")) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Microsite, cwm, fill = "Site.x")) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Microsite, cwm, fill = Site.x)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site.x, cwm, fill = Microsite)) + geom_smooth() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm, fill = Microsite)) + geom_smooth() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm, fill = Microsite)) + geom_smooth(stat = "lm") + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm, fill = Microsite)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(veg..height, cwm, fill = Microsite)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Prec, cwm)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(esi, cwm)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(cov, aes(esi, abun)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(cov, aes(esi, abun)) + geom_smooth(method = "lm") + ylab("Abundance")
ggplot(filter(CWM, Trait == "Mandible length"), aes(esi, cwm)) + geom_smooth(method = "lm") + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site.x, cwm, fill = Microsite)) + geom_scatter() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site.x, cwm, fill = Microsite)) + geom_point() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Mandible length")
mand <- filter(CWM, Trait == "Mandible length")
cor(mand$cwm, mand$dry.veg.percent)
cor(mand$cwm, mand$dry.veg.percent, na.rm = TRUE)
cor(mand$cwm, mand$dry.veg.percent, use = "complete.obs")
cor.test(mand$cwm, mand$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Mandible length")
cor.test(mand$cwm, mand$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Prec, cwm)) + geom_point() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(esi, cwm)) + geom_point() + ylab("CWM Mandible length")
femur <- filter(CWM, Trait == "Femur")
ggplot(filter(CWM, Trait == "Femur length"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Femur length")
ggplot(filter(CWM, Trait == "Femur"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Femur length")
ggplot(filter(CWM, Trait == "Femur"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Femur length")
ggplot(filter(CWM, Trait == "Femur"), aes(Prec, cwm)) + geom_point() + ylab("CWM Femur length")
ggplot(filter(CWM, Trait == "Femur"), aes(esi, cwm)) + geom_point() + ylab("CWM Femur length")
ggplot(filter(CWM, Trait == "Femur"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Femur length")
cor.test(femur$cwm, femur$veg..height, use = "complete.obs")
cor.test(femur$cwm, femur$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Femur"), aes(bare.ground.percent, cwm)) + geom_point() + ylab("CWM Femur length")
cor.test(femur$cwm, femur$bare.ground.percent, use = "complete.obs")
hl <- filter(CWM, Trait == "Head length")
ggplot(filter(CWM, Trait == "Head length"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Head length")
ggplot(filter(CWM, Trait == "Head length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Head length")
cor.test(hl$cwm, hl$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Head length"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Head length")
cor.test(hl$cwm, hl$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Head length"), aes(Prec, cwm)) + geom_point() + ylab("CWM Head length")
ggplot(filter(CWM, Trait == "Head length"), aes(esi, cwm)) + geom_point() + ylab("CWM Head length")
el <- filter(CWM, Trait == "Eye length")
ggplot(filter(CWM, Trait == "Eye length"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Eye length")
ggplot(filter(CWM, Trait == "Eye length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Eye length")
cor.test(el$cwm, el$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Eye length"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Eye length")
cor.test(el$cwm, el$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Eye length"), aes(Prec, cwm)) + geom_point() + ylab("CWM Eye length")
ggplot(filter(CWM, Trait == "Eye length"), aes(esi, cwm)) + geom_point() + ylab("CWM Eye length")
wl <- filter(CWM, Trait == "Webers")
ggplot(filter(CWM, Trait == "Webers"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Webers length")
cor.test(wl$cwm, wl$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Webers"), aes(Prec, cwm)) + geom_point() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers"), aes(esi, cwm)) + geom_point() + ylab("CWM Webers length")
ggplot(filter(CWM, Trait == "Webers"), aes(bare.ground.percent, cwm)) + geom_point() + ylab("CWM Webers length")
cor.test(wl$cwm, wl$veg..height, use = "complete.obs")
library(ade4)
data(aravo)
View(aravo)
View(aravo[["spe"]])
View(aravo[["traits"]])
View(wide)
View(traits)
View(traits.ag)
View(traits.sp)
Distribution <- as.matrix(rbind(c(1,1,0,0),c(1,0,0,0),c(0,0,1,1),c(0,0,1,0)))
T <- c(1,2,5,8)
E <- c(10,12,100,112)
n.species <- ncol(Distribution)
n.sites <- nrow(Distribution)
Dist.stacked <- as.vector(Distribution)
E.stacked <- rep(1, n.species) %x% scale(E)
T.stacked <- scale(T) %x% rep(1, n.sites)
View(T.stacked)
View(E.stacked)
View(Distribution)
Distribution <- as.matrix(rbind(c(1,1,0,0),c(1,0,0,0),c(0,0,1,1),c(0,0,1,0)))
T <- c(1,2,5,8)
E <- c(10,12,100,112)
n.species <- ncol(Distribution)
n.sites <- nrow(Distribution)
Dist.stacked <- as.vector(Distribution)
E.stacked <- rep(1, n.species) %x% scale(E)
T.stacked <- scale(T) %x% rep(1, n.sites)
predictor <- E.stacked * T.stacked
model <- glm(Dist.stacked ~ predictor,family=binomial(link=logit))
summary(model)
predictor2 <- T %x% E
E <- aravo$env[,c("Aspect","Slope","Snow")]
library(ade4)
E <- aravo$env[,c("Aspect","Slope","Snow")]
E <- as.matrix(E)
T <- as.matrix(aravo$trait)
#We need to set up our data
data(aravo)
E <- aravo$env[,c("Aspect","Slope","Snow")]
E <- as.matrix(E)
T <- as.matrix(aravo$trait)
View(`T`)
TE <- kronecker(T, E, make.dimnames = TRUE)
dim(TE)
colnames(TE)
View(`T`)
Dist.stacked <- as.vector(as.matrix(aravo$spe))
ColNames <- colnames(TE)
TE <- scale(TE) # so that slopes can be compared directly to one another
colnames(TE) <- ColNames
View(Distribution)
n.species <- ncol(Distribution)
n.sites <- nrow(Distribution)
Dist.stacked <- as.vector(Distribution)
E.stacked <- rep(1, n.species) %x% E
T.stacked <- T %x% rep(1, n.sites)
View(cbind(Dist.stacked,E.stacked,T.stacked))
library(dplyr)
library(tidyr)
library(ggplot2)
library(performance)
library(glmmTMB)
library(ade4)
wide <- read.csv("Clean Data/ants_wide.csv")
cov <- read.csv("Clean Data/ants.csv")
sites <- read.csv("Clean Data/sites_joined.csv")
cov <- right_join(sites, cov, by = c("Site", "month"))
cov <- dplyr::select(cov, 3:10, 14:19, 22:36, 39:41)
#add ecostress sensor data
eco <- read.csv("Clean Data/ecostress.csv")
eco <- select(eco, 1, 2, 11)
eco <- rename(eco, month = Category, Site = ID, esi = ECO4ESIPTJPL_001_Evaporative_Stress_Index_PT_JPL_ESIavg)
cov <- right_join(eco, cov, by = c("Site", "month"))
traits <- read.csv("raw data/Traits.csv")
unique(traits$Trait)
traits <- separate(traits, Photo, c("Site", "Slide", "Specimen"))
traits$Site <- gsub("Papl", "PaPl", traits$Site)
unique(traits$Site)
traits <- traits[-1,]
traits.ag <- group_by(traits, Site, X.1, Trait) %>% summarise(mean = mean(Measure), sd = sd(Measure))
traits.sp <- group_by(traits, X.1, Trait) %>% summarise(mean = mean(Measure), sd = sd(Measure))
#calculate CWM trait values
#I want to do abundance
#it's proportional abundances
site.j <- select(cov, uniID, Site)
wide <- right_join(site.j, wide, by = "uniID")
wide <- select(wide, -X)
wide <- select(wide, -12, -13)
long <- pivot_longer(wide, 3:13, names_to = "species", values_to = "count")
long <- group_by(long, uniID) %>% mutate(total = sum(count))
long <- long %>% mutate(rel.abun = count/total)
traits.ag <- rename(traits.ag, species = X.1)
traits.ag$species <- gsub(" ", "", traits.ag$species)
#this adds NA traits to 0 abundances - species isn't found at pitfall or site
join.right <- right_join(traits.ag, long, by = c("Site", "species"))
#join.left <- left_join(traits.ag, long, by = c("Site", "species"))
CWM <- mutate(join.right, cwm.prod = mean*rel.abun)
CWM <- group_by(CWM, Site, uniID, Trait) %>% summarise(cwm = sum(cwm.prod))
#can log transform the abundances to look at dominants vs subordinates
#join environmental data to CWM trait dataframe
CWM <- left_join(CWM, cov, by = "uniID")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Head length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Head length")
ggplot(filter(CWM, Trait == "Eye length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Eye length")
ggplot(filter(CWM, Trait == "Femur"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Femur")
ggplot(filter(CWM, Trait == "Scape"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Scape")
ggplot(filter(CWM, Trait == "Head width"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Head width")
ggplot(filter(CWM, Trait == "Webers body length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Webers body length")
View(CWM)
CWM <- rename(CWM, Site == Site.x)
CWM <- rename(CWM, Site == site.x)
CWM <- rename(CWM, Site.x == Site)
CWM <- rename(CWM, Site.x = Site)
CWM <- rename(CWM, Site = Site.x)
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm)) + geom_boxplot() + ylab("CWM Mandible length")
mand <- filter(CWM, Trait == "Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site.x, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Mandible length")
cor.test(mand$cwm, mand$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Mandible length")
cor.test(mand$cwm, mand$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Prec, cwm)) + geom_point() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(esi, cwm)) + geom_point() + ylab("CWM Mandible length")
mand <- filter(CWM, Trait == "Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Site, cwm, fill = Microsite)) + geom_boxplot() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(dry.veg.percent, cwm)) + geom_point() + ylab("CWM Mandible length")
cor.test(mand$cwm, mand$dry.veg.percent, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(veg..height, cwm)) + geom_point() + ylab("CWM Mandible length")
cor.test(mand$cwm, mand$veg..height, use = "complete.obs")
ggplot(filter(CWM, Trait == "Mandible length"), aes(Prec, cwm)) + geom_point() + ylab("CWM Mandible length")
ggplot(filter(CWM, Trait == "Mandible length"), aes(esi, cwm)) + geom_point() + ylab("CWM Mandible length")
set.seed(125)
E <- rnorm(n.communities)
Distribution <- as.matrix(rbind(c(1,1,0,0),c(1,0,0,0),c(0,0,1,1),c(0,0,1,0)))
Distribution
T <- c(1,2,5,8)
E <- c(10,12,100,112
E <- c(10,12,100,112)
E <- c(10,12,100,112)
TraitEnvCor(Distribution,E,T)["Fourthcorner"]
source("UtilityFunctions.R")
TraitEnvCor(Distribution,E,T)["Fourthcorner"]
E <- aravo$env[,c("Aspect","Slope","Snow")]
E <- as.matrix(E)
View(E)
T <- as.matrix(aravo$trait)
TE <- kronecker(T, E, make.dimnames = TRUE)
dim(TE)
View(TE)
Dist.stacked <- as.vector(as.matrix(aravo$spe))
ColNames <- colnames(TE)
Dist.stacked
View(aravo)
View(aravo[["spe"]])
View(wide)
View(TraitEnvCor)
View(traits)
View(traits.sp)
View(aravo)
View(aravo[["traits"]])
#for traits species should be rows, traits cols
traits.spe <- select(traits.spe, -sd)
#for traits species should be rows, traits cols
traits.spe <- select(traits.sp, -sd)
traits.spe <- pivot_wider(traits.spe, names_from = Trait, values_from = mean)
View(traits.spe)
traits.spe <- rename(traits.spe, species = X.1)
spe <- wide
View(spe)
View(traits.spe)
View(aravo)
View(aravo[["env"]])
View(cov)
env <- select(cov, uniID, 3,4,6, 12:15)
View(env)
row.names(env) <- env$uniID
env <- env[,-1]
row.names(spe) <- spe$uniID
spe <- select(spe, -1, -2)
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
row.names(traits.spe) <- traits.spe$species
traits.spe <- traits.spe[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
str(traits.spe)
traits.spe <- as.data.frame(traits.spe)
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
four.comb.ants.adj
plot(four.comb.aravo.adj, alpha = 0.05, stat = "D2")
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
env <- select(cov, uniID, 3, 12:15, 23, 27, 29, 30)
row.names(env) <- env$uniID
env <- env[,-1]
row.names(spe) <- spe$uniID
spe <- select(spe, -1, -2)
row.names(traits.spe) <- traits.spe$species
traits.spe <- traits.spe[,-1]
str(traits.spe)
#for traits species should be rows, traits cols
traits.spe <- select(traits.sp, -sd)
traits.spe <- pivot_wider(traits.spe, names_from = Trait, values_from = mean)
traits.spe <- rename(traits.spe, species = X.1)
env <- select(cov, uniID, 3, 12:15, 23, 27, 29, 30)
row.names(env) <- env$uniID
env <- env[,-1]
row.names(spe) <- spe$uniID
spe <- select(spe, -1, -2)
row.names(traits.spe) <- traits.spe$species
traits.spe <- select(traits.spe, -1, -3)
row.names(traits.spe) <- traits.spe$species
#for traits species should be rows, traits cols
traits.spe <- select(traits.sp, -sd)
traits.spe <- pivot_wider(traits.spe, names_from = Trait, values_from = mean)
traits.spe <- rename(traits.spe, species = X.1)
env <- select(cov, uniID, 3, 12:15, 23, 27, 29, 30)
row.names(env) <- env$uniID
env <- env[,-1]
row.names(spe) <- spe$uniID
spe <- select(spe, -1, -2)
row.names(traits.spe) <- traits.spe$species
traits.spe <- select(traits.spe, -1, -3)
traits.spe <- as.data.frame(traits.spe)
traits.spe <- traits.spe[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
env <- select(cov, uniID, 3, 12:15, 23, 27, 29)
row.names(env) <- env$uniID
env <- env[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999, na.rm = TRUE)
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999, na.omit = TRUE)
env <- select(cov, uniID, 3, 12:15, 23, 27)
row.names(env) <- env$uniID
env <- env[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
#for traits species should be rows, traits cols
traits.spe <- select(traits.sp, -sd)
traits.spe <- pivot_wider(traits.spe, names_from = Trait, values_from = mean)
traits.spe <- rename(traits.spe, species = X.1)
env <- select(cov, uniID, 3, 12:15, 23, 27)
row.names(env) <- env$uniID
env <- env[,-1]
row.names(spe) <- spe$uniID
spe <- select(spe, -1, -2)
row.names(traits.spe) <- traits.spe$species
traits.spe <- select(traits.spe, -1, -3)
traits.spe <- as.data.frame(traits.spe)
traits.spe <- traits.spe[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
View(TE)
View(traits.spe)
View(spe)
#for traits species should be rows, traits cols
traits.spe <- select(traits.sp, -sd)
traits.spe <- pivot_wider(traits.spe, names_from = Trait, values_from = mean)
traits.spe <- rename(traits.spe, species = X.1)
env <- select(cov, uniID, 3, 12:15, 23, 27)
row.names(env) <- env$uniID
env <- env[,-1]
spe <- wide
spe <- select(spe, -1, -2)
row.names(traits.spe) <- traits.spe$species
traits.spe <- select(traits.spe, -3)
traits.spe <- as.data.frame(traits.spe)
traits.spe <- traits.spe[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
four.comb.ants.adj
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 1, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
four.comb.ants.adj
env <- select(cov, uniID, 3, 12,15, 23, 27)
row.names(env) <- env$uniID
env <- env[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 1, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
four.comb.ants.adj
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
four.comb.ants.adj
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
plot(four.comb.ants.adj, alpha = 0.05, stat = "G")
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
env <- select(cov, uniID, 3, 12,15, 17, 23)
row.names(env) <- env$uniID
env <- env[,-1]
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
env$Microsite <- as.factor(env$Microsite)
four.comb.ants.adj <- fourthcorner(env, spe,
traits.spe, modeltype = 6, p.adjust.method.G = "none",
p.adjust.method.D = "fdr", nrepet = 999)
four.comb.ants.adj
plot(four.comb.ants.adj, alpha = 0.05, stat = "D2")
View(cov)
View(CWM)
library(dplyr)
library(tidyr)
library(ggplot2)
library(performance)
library(glmmTMB)
library(ade4)
wide <- read.csv("Clean Data/ants_wide.csv")
cov <- read.csv("Clean Data/ants.csv")
sites <- read.csv("Clean Data/sites_joined.csv")
cov <- right_join(sites, cov, by = c("Site", "month"))
cov <- dplyr::select(cov, 3:10, 14:19, 22:36, 39:41)
#add ecostress sensor data
eco <- read.csv("Clean Data/ecostress.csv")
eco <- select(eco, 1, 2, 11)
eco <- rename(eco, month = Category, Site = ID, esi = ECO4ESIPTJPL_001_Evaporative_Stress_Index_PT_JPL_ESIavg)
cov <- right_join(eco, cov, by = c("Site", "month"))
cor <- pivot_wider(CWM, names_from = Trait, values_from = cwm)
M <- cor(cor)
mat <- pivot_wider(CWM, names_from = Trait, values_from = cwm)
View(mat)
M <- cor(mat)
mat <- select(mat, 5:11, 14:17, 25:31, 35:42)
M <- cor(mat)
mat <- pivot_wider(CWM, names_from = Trait, values_from = cwm)
mat <- select(mat, 5:11, 14:17, 25:31, 35:42) %>% ungroup(mat)
M <- cor(mat)
mat <- select(mat, 5:11, 14:17, 25:31, 35:42) %>% ungroup()
mat <- ungroup(mat)
mat <- ungroup(mat) %>% select(-uniID)
M <- cor(mat)
corrplot::corrplot(M)
corrplot::corrplot(M)
corrplot::corrplot(M)
corrplot::corrplot(M, na.omit = TRUE)
corrplot::corrplot(M, na.rm = TRUE)
warnings()
M <- cor(mat, na.rm = TRUE)
M <- cor(mat, na.omit = TRUE)
M <- cor(mat, na.rm = TRUE)
mat <- drop_na(mat)
M <- cor(mat)
corrplot::corrplot(M)
corrplot::corrplot(M)
corrplot::corrplot(M. method = number)
corrplot::corrplot(M, method = number)
corrplot::corrplot(M, method = "number")
